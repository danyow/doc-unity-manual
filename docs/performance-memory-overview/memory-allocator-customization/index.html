<!doctype html>
<html class="docs-version-current" lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Unity ÊâãÂÜå RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Unity ÊâãÂÜå Atom Feed"><title data-rh="true">Memory allocator customization | Unity ÊâãÂÜå</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://danyow.github.io/doc-unity-manual//docs/performance-memory-overview/memory-allocator-customization"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Memory allocator customization | Unity ÊâãÂÜå"><meta data-rh="true" name="description" content="When you are optimizing your application‚Äôs performance, one important factor to consider is the allocation of memory. This documentation provides information on Unity‚Äôs native memory allocator types, and describes scenarios where you can customize the allocators to improve performance. It is intended for users with a general understanding of allocators."><meta data-rh="true" property="og:description" content="When you are optimizing your application‚Äôs performance, one important factor to consider is the allocation of memory. This documentation provides information on Unity‚Äôs native memory allocator types, and describes scenarios where you can customize the allocators to improve performance. It is intended for users with a general understanding of allocators."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://danyow.github.io/doc-unity-manual//docs/performance-memory-overview/memory-allocator-customization"><link data-rh="true" rel="alternate" href="http://danyow.github.io/doc-unity-manual//docs/performance-memory-overview/memory-allocator-customization" hreflang="zh"><link data-rh="true" rel="alternate" href="http://danyow.github.io/doc-unity-manual//docs/performance-memory-overview/memory-allocator-customization" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3b98a603.css">
<link rel="preload" href="/assets/js/runtime~main.13c240a3.js" as="script">
<link rel="preload" href="/assets/js/main.8f4a8c68.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Ë∑≥Âà∞‰∏ªË¶ÅÂÜÖÂÆπ</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">My Site</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="ÂàáÊç¢ÊµÖËâ≤/ÊöóÈªëÊ®°ÂºèÔºàÂΩìÂâç‰∏∫ÊµÖËâ≤Ê®°ÂºèÔºâ"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="ÂõûÂà∞È°∂ÈÉ®" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/tutorial-basics/create-a-page">Tutorial - Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/tutorial-extras/manage-docs-versions">Tutorial - Extras</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/animation-section">animation-section</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåanimation-section„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/asset-store">asset-store</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåasset-store„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/asset-workflow">asset-workflow</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåasset-workflow„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/audio">audio</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåaudio„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/creating-environments">creating-environments</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåcreating-environments„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Glossary">ÊúØËØ≠Ë°®</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/graphics">graphics</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äågraphics„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/input">input</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåinput„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/legacy-topics">legacy-topics</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äålegacy-topics„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/navigation">navigation</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äånavigation„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/open-source-repositories">open-source-repositories</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåopen-source-repositories„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/packages-list">packages-list</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåpackages-list„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/physics-section">physics-section</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåphysics-section„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/platform-specific">platform-specific</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåplatform-specific„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/scripting-section">scripting-section</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåscripting-section„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/search-overview">search-overview</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåsearch-overview„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/uitoolkits">uitoolkits</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåuitoolkits„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/unet">unet</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåunet„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/unity-manual">unity-manual</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/unity-overview">unity-overview</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåunity-overview„Äç" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/docs/analysis">analysis</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåanalysis„Äç" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/analysis/async-read-manager-metrics">ËµÑÊ∫êÂä†ËΩΩÊåáÊ†á</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/best-practice-understanding-performance-in-unity">best-practice-understanding-performance-in-unity</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåbest-practice-understanding-performance-in-unity„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/analysis/log-files">Log files</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/docs/performance-memory-overview">performance-memory-overview</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåperformance-memory-overview„Äç" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/performance-memory-overview/memory-allocator-customization">Memory allocator customization</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/performance-garbage-collector">performance-garbage-collector</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåperformance-garbage-collector„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/performance-memory-overview/performance-managed-memory">Managed memory</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/performance-profiling-tools">performance-profiling-tools</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåperformance-profiling-tools„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/profiler">profiler</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåprofiler„Äç" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/creating-gameplay">creating-gameplay</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåcreating-gameplay„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/editor-features">editor-features</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåeditor-features„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/getting-started-installing-unity">getting-started-installing-unity</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äågetting-started-installing-unity„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/quickstart-guides">quickstart-guides</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåquickstart-guides„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/upgrade-guides">upgrade-guides</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåupgrade-guides„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/using-the-editor">using-the-editor</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåusing-the-editor„Äç" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/unity-services">unity-services</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåunity-services„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/unity2d">unity2d</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåunity2d„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/video-player">video-player</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåvideo-player„Äç" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/xr">xr</a><button aria-label="ÊâìÂºÄ/Êî∂Ëµ∑‰æßËæπÊ†èËèúÂçï„Äåxr„Äç" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">üè†</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/unity-overview">unity-overview</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/analysis">analysis</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/performance-memory-overview">performance-memory-overview</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/performance-memory-overview/memory-allocator-customization">Memory allocator customization</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">Êú¨È°µÊÄªËßà</button></div><div class="theme-doc-markdown markdown"><h1>Memory allocator customization</h1><p>When you are optimizing your application‚Äôs performance, one important factor to consider is the allocation of memory. This documentation provides information on Unity‚Äôs native memory allocator types, and describes scenarios where you can customize the allocators to improve performance. It is intended for users with a general understanding of allocators.</p><p>For a full reference of allocator types and their default values, see <a href="#which-you-can-customize">Customizing allocators</a>.</p><p>An application uses memory allocators to balance performance and available memory space. If an application has a lot of spare memory, it can favour faster, memory-heavy allocators when it loads scenes and frames. However, if the application has limited memory, it needs to use that memory efficiently, even if that means using slower allocators. To help you get the best performance for different projects, you can customize Unity‚Äôs allocators to fit the size and requirements of each application.</p><p>Unity has five allocator types. Each type has a different algorithm for fitting allocations into blocks of memory, and is therefore useful for different allocations. The important difference between allocations is usually persistence, or allocation lifespan, which determines where an allocation should go. For example, a long-live (persistent) allocation goes to the heap and bucket allocators, while short-lived allocations go to the threadsafe linear and TLS allocators.</p><p>This table lists the algorithm and uses of each allocator type:</p><table><thead><tr><th><strong>Allocator type</strong></th><th><strong>Algorithm</strong></th><th><strong>Used for</strong></th></tr></thead><tbody><tr><td>Dynamic heap</td><td>Two Level Segregated Fit (TLSF)</td><td>‚Ä¢ Main allocator<br>‚Ä¢ Gfx allocator<br>‚Ä¢ Typetree allocator<br>‚Ä¢ File cache allocator<br>‚Ä¢ Profiler allocator<br>‚Ä¢ Editor Profiler allocator (on Editor only)</td></tr><tr><td>Bucket</td><td>Fixed size lock-free allocator</td><td>As a shared allocator for small allocations for:<br><br>‚Ä¢ Main allocator<br>‚Ä¢ Gfx allocator<br>‚Ä¢ Typetree allocator<br>‚Ä¢ File cache allocator</td></tr><tr><td>Dual thread</td><td>Redirects allocations based on size and thread ID</td><td>‚Ä¢ Main allocator<br>‚Ä¢ Gfx allocator<br>‚Ä¢ Typetree allocator<br>‚Ä¢ File cache allocator</td></tr><tr><td>Thread Local Storage (TLS) stack</td><td>LIFO stack</td><td>Temporary allocations</td></tr><tr><td>Threadsafe linear</td><td>Round robin FIFO</td><td>Buffers for passing data to jobs</td></tr></tbody></table><p> <strong>Note</strong> : The examples in this documentation use the memory usage reports that are written to the log when you close the player or Editor. To find your log files, follow the instructions on <a href="/docs/analysis/log-files">the log files page</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="dynamic-heap-bucket-and-dual-thread-allocators">Dynamic heap, bucket, and dual thread allocators<a class="hash-link" href="#dynamic-heap-bucket-and-dual-thread-allocators" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h2><p>This section reviews the functionality and customization scenarios for the dynamic heap, bucket and dual thread allocators.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="Ê¶ÇËø∞">Ê¶ÇËø∞<a class="hash-link" href="#Ê¶ÇËø∞" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h3><p>The  <strong>dual thread allocator</strong>  is a wrapper that combines  <strong>dynamic</strong>  and  <strong>bucket</strong>  allocators. More specifically, it combines:</p><ul><li>Two dynamic heap allocators: A lock-free allocator for the main thread, and an allocator that is shared by all other threads, which locks on allocation and deallocation. Unity uses these allocators for allocations that are too large for the bucket allocator. The dynamic heap allocator uses memory blocks. Allocations that are equal to or greater than half a block go to the virtual memory system instead of the dynamic heap allocator.</li><li>A bucket allocator for small allocations. If the bucket allocator is full, allocation spills over into the dynamic heap allocator.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="dynamic-heap-allocator">Dynamic heap allocator<a class="hash-link" href="#dynamic-heap-allocator" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h3><p>The main heap allocator is the dynamic heap allocator. It applies the algorithm Two Level Segregated Fit (TLSF) to blocks of memory.</p><p>Each platform has a default block size, <a href="#which-you-can-customize">which you can customize</a>. An allocation must be smaller than half a block. If an allocation is equal to or greater than half a block, it is too large for the dynamic heap allocator; instead, Unity uses the virtual memory API to make the allocation.</p><p>An example usage report for the dynamic heap allocator:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[ALLOC_DEFAULT_MAIN]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Peak usage frame count: [16.0 MB-32.0 MB]: 497 frames, [32.0 MB-64.0 MB]: 1 frames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Requested Block Size 16.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Peak Block count 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Peak Allocated memory 54.2 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Peak Large allocation bytes 40.2 MB</span><br></span></code></pre><button type="button" aria-label="Â§çÂà∂‰ª£Á†ÅÂà∞Ââ™Ë¥¥Êùø" class="copyButton_wuS7 clean-btn">Â§çÂà∂</button></div></div><p>In this example, the TLSF block size is set to 16 MB, and Unity has allocated two blocks. The peak usage of the allocator was 54.2MB. Of those 52.4MB, 40.2MB were not allocated in the TLSF block, and instead fell back to virtual memory. Most frames had 16‚Äì32MB of allocated memory, while one frame - likely the loading frame - peaked at 32‚Äì64MB of memory.</p><p>If you increased the block size the large allocation would stay in the dynamic heap rather than fall back into virtual memory. However, that block size could lead to memory waste, because the blocks might not be fully used.</p><p>To avoid using the typetree and cache allocators, set their size to 0. Allocations that would have used typetree and cache will instead fall back to the main allocator. This can cause more fragmentation, but saves the memory of those allocators‚Äô memory blocks.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="bucket-allocator">Bucket allocator<a class="hash-link" href="#bucket-allocator" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h3><p>The bucket allocator is a fast lock-free allocator that performs small allocations. Usually, the bucket allocator is used as a first step to speed up small allocations, before they go to the heap allocator.</p><p>The allocator reserves blocks of memory for allocations. Each block is divided into  <strong>subsections</strong>  of 16KB. This is not configurable, and does not appear in the user interface. Each subsection is divided into  <strong>allocations</strong> . The allocation size is a multiple of a configured fixed size, called  <strong>granularity</strong> .</p><p>The following example setup demonstrates the process of reserving blocks for allocations:</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/Shared_Bucket.png" alt="Shared Bucket Allocator for the Windows, Mac and Linux player"></p><p>Shared Bucket Allocator for the Windows, Mac and Linux player</p><p>In this setup, the total  <strong>block</strong>  size ( <strong>Bucket Allocator Block Size</strong> ) is 4MB, and the granularity of allocations ( <strong>Bucket Allocator Granularity</strong> ) is 16B. The first allocation is 16B, the second is 32B (2<!-- -->*<!-- -->16), then 48B, 64B, 80B, 96B, 112B, and 128B, for a total of eight buckets ( <strong>Bucket Allocator BucketCount</strong> ).</p><p>Each subsection contains a different number of buckets. To calculate the number of buckets in a subsection, divide the subsection size (16KB) by the granularity size. For example:</p><ul><li>When the allocation granularity is 64B, 256 buckets fit in a subsection.</li><li>When the allocation granularity is 16B, 1,024 buckets fit in a subsection.</li></ul><p>Bucket allocators produce different usage reports for a development build and a release build, because a development build, each allocation has a header of an additional 40B. The following diagram demonstrates the difference between development and release builds for 16B and 64B allocations:</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/memory_allocation.png" alt="Development and Release builds comparison"></p><p>Development and Release builds comparison</p><p>The header is also the reason the allocator reports it is full after allocating only 2MB of its 4MB:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[ALLOC_BUCKET]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Large Block size 4.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Used Block count 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Allocated bytes 2.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Failed Allocations. Bucket layout:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        16B: 64 Subsections = 18724 buckets. Failed count: 3889</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        32B: 17 Subsections = 3868 buckets. Failed count: 169583</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        48B: 31 Subsections = 5771 buckets. Failed count: 39674</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        64B: 28 Subsections = 4411 buckets. Failed count: 9981</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        80B: 17 Subsections = 2321 buckets. Failed count: 14299</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        96B: 6 Subsections = 722 buckets. Failed count: 9384</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        112B: 44 Subsections = 4742 buckets. Failed count: 5909</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        128B: 49 Subsections = 4778 buckets. Failed count: 8715</span><br></span></code></pre><button type="button" aria-label="Â§çÂà∂‰ª£Á†ÅÂà∞Ââ™Ë¥¥Êùø" class="copyButton_wuS7 clean-btn">Â§çÂà∂</button></div></div><p>In a release build for the same project, the allocator block size is enough:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[ALLOC_BUCKET]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Large Block size 4.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Used Block count 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Allocated bytes 3.3 MB</span><br></span></code></pre><button type="button" aria-label="Â§çÂà∂‰ª£Á†ÅÂà∞Ââ™Ë¥¥Êùø" class="copyButton_wuS7 clean-btn">Â§çÂà∂</button></div></div><p>If the bucket allocator is full, the allocation falls back to another allocator. The usage report displays usage statistics, including how many allocations failed. If the report displays a fail count that increases linearly, it is likely that the failed allocations happen when calculating the frames, not the load. Fallback allocations are not a problem for a scene load, but they can impact performance if they happen when calculating frames.</p><p>To prevent these fallback allocations, increase the block size, and limit the new block size to match the frames‚Äô peak usage, rather than the scene load peak usage. This prevents the block from becoming so large that it reserves a lot of memory that is then not available at runtime.</p><p> <strong>Tip</strong> : The Profiler allocators share an instance of a bucket allocator. You can customize this shared instance in the <a href="#shared-profiler-bucket-allocator">Shared Profiler Bucket Allocator</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="dual-thread-allocator">Dual thread allocator<a class="hash-link" href="#dual-thread-allocator" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h3><p>The dual thread allocator wraps a shared bucket allocator for small allocations, and two instances of the dynamic heap allocator: a lock-free allocator for the main thread, and an allocator that is shared by all other threads, but locks on allocation and deallocation.</p><p>You can customize the block sizes of the two dynamic heap allocators:</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/Main_Allocator.png" alt="Main Allocator, with a custom value for Shared Thread Block Size"></p><p>Main Allocator, with a custom value for Shared Thread Block Size</p><p>The usage report contains information for all three parts of the allocator. For example:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[ALLOC_DEFAULT] Dual Thread Allocator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Peak main deferred allocation count 135</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ALLOC_BUCKET]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Large Block size 4.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Used Block count 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Allocated bytes 3.3 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ALLOC_DEFAULT_MAIN]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak usage frame count: [16.0 MB-32.0 MB]: 8283 frames, [32.0 MB-64.0 MB]: 1 frames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Requested Block Size 16.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Block count 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Allocated memory 53.3 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Large allocation bytes 40.2 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ALLOC_DEFAULT_THREAD]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak usage frame count: [64.0 MB-128.0 MB]: 8284 frames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Requested Block Size 16.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Block count 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Allocated memory 78.3 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Large allocation bytes 47.3 MB</span><br></span></code></pre><button type="button" aria-label="Â§çÂà∂‰ª£Á†ÅÂà∞Ââ™Ë¥¥Êùø" class="copyButton_wuS7 clean-btn">Â§çÂà∂</button></div></div><p> <strong>Note</strong> : The  <strong>Peak main deferred allocation count</strong>  is the number of items in a deletion queue. The main thread must delete any allocation it made. If another thread deletes an allocation, that allocation is added to a queue. The allocation waits in the queue for the main thread to delete it. It is then counted as a deferred allocation.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="tls-and-threadsafe-linear-allocators">TLS and threadsafe linear allocators<a class="hash-link" href="#tls-and-threadsafe-linear-allocators" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h2><p>This section describes the functionality and customization scenarios for the Thread Local Storage (TLS) and threadsafe linear allocators.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="Ê¶ÇËø∞-1">Ê¶ÇËø∞<a class="hash-link" href="#Ê¶ÇËø∞-1" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h3><p>Unity has two allocators that work outside the dual thread allocator:</p><ul><li>Thread Local Storage (TLS): A stack-based allocator for fast temporary allocations. This is the fastest allocator because it has almost no overhead. It also prevents fragmentation. It is Last In, First Out (LIFO)-based.</li><li>Threadsafe linear: A First In, First Out (FIFO) round-robin allocator that the temporary job allocation uses to pass short-lived memory between worker threads).</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="thread-local-storage-tls-stack-allocator">Thread Local Storage (TLS) stack allocator<a class="hash-link" href="#thread-local-storage-tls-stack-allocator" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h3><p>Each thread uses its own fast stack allocator for temporary allocations. These allocations are very fast, with a lifespan of less than a frame.</p><p>The default block size for the temporary allocator is 4MB for the platforms and 16MB for the Unity Editor. You can customize these values.</p><p> <strong>Note</strong> : If the allocator use exceeds the configured block size, Unity increases the block size. The limit for this increase is twice the original size.</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/Per_Thread.png" alt="Main Thread Block Size custom value in the Fast Per Thread Temporary Allocators"></p><p>Main Thread Block Size custom value in the Fast Per Thread Temporary Allocators</p><p>If a thread‚Äôs stack allocator is full, allocations fall back to the <a href="#threadsafe-linear-job-allocator">threadsafe linear job allocator</a>. A few overflow allocations are fine: 1 to 10 in a frame, or a few hundred during load. However, if the numbers grow on every frame, you can increase the block sizes.</p><p>The information in the usage report can help you select a block size that is appropriate for your application. For example, in the following main thread usage report, the load peaks at 2.7MB, but the remaining frames are below 64KB. You can reduce the block size from 4MB to 64KB and allow the loading frame to spill over the allocations:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[ALLOC_TEMP_TLS] TLS Allocator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  StackAllocators :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ALLOC_TEMP_MAIN]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak usage frame count: [16.0 KB-32.0 KB]: 802 frames, [32.0 KB-64.0 KB]: 424 frames, [2.0 MB-4.0 MB]: 1 frames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Initial Block Size 4.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Current Block Size 4.0 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Allocated Bytes 2.7 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Overflow Count 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ALLOC_TEMP_Job.Worker 18]</span><br></span></code></pre><button type="button" aria-label="Â§çÂà∂‰ª£Á†ÅÂà∞Ââ™Ë¥¥Êùø" class="copyButton_wuS7 clean-btn">Â§çÂà∂</button></div></div><p>In this second example, the worker thread is not used for large temporary allocations. To save memory, you can reduce the worker‚Äôs block size to 32KB. This is especially useful on a multi-core machine, where each worker thread has its own stack:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[ALLOC_TEMP_Job.Worker 14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Initial Block Size 256.0 KB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Current Block Size 256.0 KB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Peak Allocated Bytes 18.6 KB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Overflow Count 0</span><br></span></code></pre><button type="button" aria-label="Â§çÂà∂‰ª£Á†ÅÂà∞Ââ™Ë¥¥Êùø" class="copyButton_wuS7 clean-btn">Â§çÂà∂</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="threadsafe-linear-allocator">Threadsafe linear allocator<a class="hash-link" href="#threadsafe-linear-allocator" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h3><p>The worker threads in Unity use a round robin first-in-first-out (FIFO) algorithm for fast, lock-free allocations of work buffers for jobs. The jobs dispose of the buffers when done.</p><p>This allocator allocates blocks of memory, then linearly allocates memory within those blocks. Available blocks are held in a pool. When one block is full, the allocator fetches a new block from the pool. When the allocator no longer needs the memory in a block, it clears the block, and the block returns to the pool of available blocks. It is important to clear allocations quickly to make blocks available again, so a job should not stay allocated for more than a few frames.</p><p>You can customize the block size. The allocator allocates up to 64 blocks, as needed.</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/Fast_Thread.png" alt="Default value for Fast Thread Shared Temporary Allocators for the Editor"></p><p>Default value for Fast Thread Shared Temporary Allocators for the Editor</p><p>If all blocks are in use, or an allocation is too big for a block, the allocation falls back to the main heap allocator, which is much slower than the job allocator. A few overflow allocations are fine: 1 to 10 in a frame, or a few hundred, especially during load. If the overflow count grows with every frame, you can increase the block size to avoid fallback allocations. However, if you increase the block size too much (for example, to match peak use in events such as scene loading), you might leave a lot of memory unavailable during play.</p><p>‰æãÂ¶ÇÔºö</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[ALLOC_TEMP_JOB_4_FRAMES (JobTemp)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Initial Block Size 0.5 MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Used Block Count 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Overflow Count (too large) 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Overflow Count (full) 50408</span><br></span></code></pre><button type="button" aria-label="Â§çÂà∂‰ª£Á†ÅÂà∞Ââ™Ë¥¥Êùø" class="copyButton_wuS7 clean-btn">Â§çÂà∂</button></div></div><p>In this example usage report, the 0.5MB block size was too small to accommodate the job memory that the application needed, and the full allocator caused a large number of allocations to overflow.</p><p>To check whether your build‚Äôs frame overflow is sufficient, run it for a short time and then for a longer time. If the overflow count remains steady, the overflow is a high watermark that occurs during load. If the overflow count increases with a longer run, the build is processing a per-frame overflow. In both cases, you can increase the blocksize to reduce the overflow, but the overflow is less critical during load than per frame.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="customizing-allocators">Customizing allocators<a class="hash-link" href="#customizing-allocators" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h2><p>To customize allocator settings, do one of the following:</p><ul><li>Use the Editor:<ol><li>Select <em>Project Settings</em> <!-- -->&gt;<!-- --> <em>Memory Settings</em>.</li><li>Select the lock icon next to the value you want to edit.</li></ol></li></ul><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/Memory_Settings.png" alt="Project Settings &gt; Memory Settings, showing a selection of Player memory settings"></p><p>Project Settings <!-- -->&gt;<!-- --> Memory Settings, showing a selection of Player memory settings</p><ul><li>Use command line arguments. To find the name of the allocator parameters you want to change, check the list of allocator settings the Editor and players print when they start up. For example, to change the block size of the main heap allocators, use <code>-memorysetup-main-allocator-block-size=&amp;lt;new_value&amp;gt;</code></li></ul><p>The allocator parameter names and their default values:</p><table><thead><tr><th><strong>Allocator</strong></th><th><strong>ÊèèËø∞</strong></th><th><strong>Parameter name</strong></th><th><strong>Default value</strong></th></tr></thead><tbody><tr><td>Main Allocators</td><td>The allocators Unity uses for most allocations.</td><td></td><td></td></tr><tr><td>-&gt; Main Allocator</td><td>The primary allocator Unity uses for most allocations.</td><td></td><td></td></tr><tr><td>-&gt;</td><td>Main Thread Block Size</td><td>Block size of dedicated main thread allocator.</td><td><code>memorysetup-main-allocator-block-size</code></td></tr><tr><td>-&gt;</td><td>Shared Thread Block Size</td><td>Block size of shared thread allocator.</td><td><code>memorysetup-thread-allocator-block-size</code></td></tr><tr><td>-&gt; Gfx Allocator</td><td>The allocator Unity uses for CPU allocations related to the Gfx system.</td><td></td><td></td></tr><tr><td>-&gt;</td><td>Main Thread Block Size</td><td>Block size of the dedicated main thread Gfx allocator.</td><td><code>memorysetup-gfx-main-allocator-block-size</code></td></tr><tr><td>-&gt;</td><td>Shared Thread Block Size</td><td>Block size of the shared thread Gfx allocator.</td><td><code>memorysetup-gfx-thread-allocator-block-size</code></td></tr><tr><td>-&gt; Other Allocators</td><td></td><td></td><td></td></tr><tr><td>-&gt;</td><td>File Cache Block Size</td><td>The file cache has its own allocator to avoid fragmentation. This is its block size.</td><td><code>memorysetup-cache-allocator-block-size</code></td></tr><tr><td>-&gt;</td><td>Type Tree Block Size</td><td>The type treess have their own allocator to avoid fragmentation due to many small allocations. This is its block size.</td><td><code>memorysetup-typetree-allocator-block-size</code></td></tr><tr><td>-&gt; Shared Bucket Allocator</td><td>The bucket allocator that is shared between the main allocators.</td><td></td><td></td></tr><tr><td>-&gt;</td><td>Bucket Allocator Granularity</td><td>Step size for buckets in the shared allocator.</td><td><code>memorysetup-bucket-allocator-granularity</code></td></tr><tr><td>-&gt;</td><td>Bucket Allocator BucketCount</td><td>Number of bucket sizes.</td><td><code>memorysetup-bucket-allocator-bucket-count</code></td></tr><tr><td>-&gt;</td><td>Bucket Allocator Block Size</td><td>Size of memory blocks used for buckets.</td><td><code>memorysetup-bucket-allocator-block-size</code></td></tr><tr><td>-&gt;</td><td>Bucket Allocator Block Count</td><td>Maximum number of blocks to be allocated.</td><td><code>memorysetup-bucket-allocator-block-count</code></td></tr><tr><td>Fast Per Thread Temporary Allocators</td><td>The Thread Local Storage (TLS) allocator that handles very short-lived allocations.</td><td></td><td></td></tr><tr><td>-&gt; Main Thread Block Size</td><td>The initial size for the main thread stack.</td><td><code>memorysetup-temp-allocator-size-main</code></td><td><code>Editor: 16777216</code><br><code>Player: 4194304</code></td></tr><tr><td>-&gt; Job Worker Block Size</td><td>Size of each job worker in the Unity job system.</td><td><code>memorysetup-temp-allocator-size-job-worker</code></td><td><code>E262144</code></td></tr><tr><td>-&gt; Background Job Worker Block Size</td><td>Size for each background worker.</td><td><code>memorysetup-temp-allocator-size-background-worker</code></td><td><code>32768</code></td></tr><tr><td>-&gt; Preload Block Size</td><td>The preload manager stack size.</td><td><code>memorysetup-temp-allocator-size-preload-manager</code></td><td><code>Editor: 33554432</code><br><code>Player: 262144</code></td></tr><tr><td>-&gt; Audio Worker Block Size</td><td>Each audio worker thread‚Äôs stack size.</td><td><code>memorysetup-temp-allocator-size-audio-worker</code></td><td><code>65536</code></td></tr><tr><td>-&gt; Cloud Worker Block Size</td><td>Cloud worker threads stack size.</td><td><code>memorysetup-temp-allocator-size-cloud-worker</code></td><td><code>32768</code></td></tr><tr><td>-&gt; Gfx Thread Blocksize</td><td>The main render threads stack size.</td><td><code>memorysetup-temp-allocator-size-gfx</code></td><td><code>262144</code></td></tr><tr><td>-&gt; GI Baking Blocksize</td><td>Each GI worker thread‚Äôs stack size.</td><td><code>memorysetup-temp-allocator-size-gi-baking-worker</code></td><td><code>262144</code></td></tr><tr><td>-&gt; NavMesh Worker Block Size</td><td>Nav mesh worker threads stack size.</td><td><code>memorysetup-temp-allocator-size-nav-mesh-worker</code></td><td><code>65536</code></td></tr><tr><td>Fast Thread Shared Temporary Allocators</td><td>Fast linear allocator for short lived allocations shared between threads.</td><td></td><td></td></tr><tr><td>-&gt; Job Allocator Block Size</td><td>The round robin linear thread allocator Unity mainly uses for the job worker threads.</td><td><code>memorysetup-job-temp-allocator-block-size</code></td><td><code>2097152</code></td></tr><tr><td>-&gt; Background Job Allocator Block Size</td><td>The linear allocator for the background workers that allows longer lived allocations.</td><td><code>memorysetup-job-temp-allocator-block-size-background</code></td><td><code>21048576</code></td></tr><tr><td>-&gt; Job Allocator Block Size on low memory platforms</td><td>Platforms with less than 2GB memory use this size for both the job workers and the background jobs.</td><td><code>memorysetup-job-temp-allocator-reduction-small-platforms</code></td><td><code>262144</code></td></tr><tr><td>Profiler Allocators</td><td>Allocators that Unity uses exclusively for the Profiler so that they don‚Äôt interfere with the application‚Äôs allocation patterns.</td><td></td><td></td></tr><tr><td>-&gt; Profiler Block Size</td><td>The block size for the main part of the Profiler.</td><td><code>memorysetup-profiler-allocator-block-size</code></td><td><code>16777216</code></td></tr><tr><td>-&gt; Editor Profiler Block Size</td><td>Block size for the Editor part of the Profiler. This is not present on players.</td><td><code>memorysetup-profiler-editor-allocator-block-size</code></td><td><code>1048576</code></td></tr><tr><td>-&gt; Shared Profiler Bucket Allocator</td><td>Shared bucket allocator for the Profiler and Editor Profiler allocators.<br><br>Not present on low memory platforms.</td><td></td><td></td></tr><tr><td>-&gt;</td><td>Bucket Allocator Granularity</td><td>Step size for buckets in the shared allocator.</td><td><code>memorysetup-profiler-bucket-allocator-granularity</code></td></tr><tr><td>-&gt;</td><td>Bucket Allocator BucketCount</td><td>Number of bucket sizes. For example, if the value is 4, the sizes are 16, 32, 48 and 64.</td><td><code>memorysetup-profiler-bucket-allocator-bucket-count</code></td></tr><tr><td>-&gt;</td><td>Bucket Allocator Block Size</td><td>Size of memory blocks used for buckets.</td><td><code>memorysetup-profiler-bucket-allocator-block-size</code></td></tr><tr><td>-&gt;</td><td>Bucket Allocator Block Count</td><td>Maximum number of blocks to be allocated.</td><td><code>memorysetup-profiler-bucket-allocator-block-count</code></td></tr></tbody></table><p> <strong>Tip</strong> : To ensure your settings improve performance, profile the application before and after making changes. See the <a href="/docs/profiler">Profiler overview page</a> for more information. You can also check the memory usage reports. They are available in the log when you close the player or Editor. To find your log files, follow the instructions on the <a href="/docs/analysis/log-files">log files page</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="storing-and-reading-the-settings">Storing and reading the settings<a class="hash-link" href="#storing-and-reading-the-settings" title="Ê†áÈ¢òÁöÑÁõ¥Êé•ÈìæÊé•">‚Äã</a></h2><p>Unity stores allocator settings in <code>MemorySettings.asset</code>, which populates the <code>boot.config</code> file with the modified settings at build time. This means new settings take effect at every build.</p><p>In the Editor, the <code>boot.config</code> is in the <code>ProjectSettings</code> folder. It gets updated every time Unity imports or changes <code>MemorySettings.asset</code>. New values for the Editor only take effect on the next Editor startup.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/unity-overview/analysis/performance-memory-overview/memory-allocator-customization.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ÁºñËæëÊ≠§È°µ</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ÊñáÊ°£ÂàÜÈ°µÂØºËà™"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/performance-memory-overview"><div class="pagination-nav__sublabel">‰∏ä‰∏ÄÈ°µ</div><div class="pagination-nav__label">Memory in Unity</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/performance-garbage-collector"><div class="pagination-nav__sublabel">‰∏ã‰∏ÄÈ°µ</div><div class="pagination-nav__label">Garbage collector overview</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dynamic-heap-bucket-and-dual-thread-allocators" class="table-of-contents__link toc-highlight">Dynamic heap, bucket, and dual thread allocators</a><ul><li><a href="#Ê¶ÇËø∞" class="table-of-contents__link toc-highlight">Ê¶ÇËø∞</a></li><li><a href="#dynamic-heap-allocator" class="table-of-contents__link toc-highlight">Dynamic heap allocator</a></li><li><a href="#bucket-allocator" class="table-of-contents__link toc-highlight">Bucket allocator</a></li><li><a href="#dual-thread-allocator" class="table-of-contents__link toc-highlight">Dual thread allocator</a></li></ul></li><li><a href="#tls-and-threadsafe-linear-allocators" class="table-of-contents__link toc-highlight">TLS and threadsafe linear allocators</a><ul><li><a href="#Ê¶ÇËø∞-1" class="table-of-contents__link toc-highlight">Ê¶ÇËø∞</a></li><li><a href="#thread-local-storage-tls-stack-allocator" class="table-of-contents__link toc-highlight">Thread Local Storage (TLS) stack allocator</a></li><li><a href="#threadsafe-linear-allocator" class="table-of-contents__link toc-highlight">Threadsafe linear allocator</a></li></ul></li><li><a href="#customizing-allocators" class="table-of-contents__link toc-highlight">Customizing allocators</a></li><li><a href="#storing-and-reading-the-settings" class="table-of-contents__link toc-highlight">Storing and reading the settings</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.13c240a3.js"></script>
<script src="/assets/js/main.8f4a8c68.js"></script>
</body>
</html>