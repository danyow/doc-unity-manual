<!doctype html>
<html class="docs-version-current" lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Unity 手册 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Unity 手册 Atom Feed"><title data-rh="true">自定义着色器基础 | Unity 手册</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://danyow.github.io/doc-unity-manual//docs/built-in-shader-examples/sl-vertex-fragment-shader-examples"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="自定义着色器基础 | Unity 手册"><meta data-rh="true" name="description" content="这些内置渲染管线的着色器示例演示了编写自定义着色器的基础知识，并涵盖了常见的用例。"><meta data-rh="true" property="og:description" content="这些内置渲染管线的着色器示例演示了编写自定义着色器的基础知识，并涵盖了常见的用例。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://danyow.github.io/doc-unity-manual//docs/built-in-shader-examples/sl-vertex-fragment-shader-examples"><link data-rh="true" rel="alternate" href="http://danyow.github.io/doc-unity-manual//docs/built-in-shader-examples/sl-vertex-fragment-shader-examples" hreflang="zh"><link data-rh="true" rel="alternate" href="http://danyow.github.io/doc-unity-manual//docs/built-in-shader-examples/sl-vertex-fragment-shader-examples" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3b98a603.css">
<link rel="preload" href="/assets/js/runtime~main.13c240a3.js" as="script">
<link rel="preload" href="/assets/js/main.8f4a8c68.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">My Site</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="切换浅色/暗黑模式（当前为浅色模式）"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/tutorial-basics/create-a-page">Tutorial - Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/tutorial-extras/manage-docs-versions">Tutorial - Extras</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/animation-section">animation-section</a><button aria-label="打开/收起侧边栏菜单「animation-section」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/asset-store">asset-store</a><button aria-label="打开/收起侧边栏菜单「asset-store」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/asset-workflow">asset-workflow</a><button aria-label="打开/收起侧边栏菜单「asset-workflow」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/audio">audio</a><button aria-label="打开/收起侧边栏菜单「audio」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/creating-environments">creating-environments</a><button aria-label="打开/收起侧边栏菜单「creating-environments」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Glossary">术语表</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/graphics">graphics</a><button aria-label="打开/收起侧边栏菜单「graphics」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/cameras-overview">cameras-overview</a><button aria-label="打开/收起侧边栏菜单「cameras-overview」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/graphics-apis">graphics-apis</a><button aria-label="打开/收起侧边栏菜单「graphics-apis」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/graphics-color">graphics-color</a><button aria-label="打开/收起侧边栏菜单「graphics-color」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/graphics-performance-profiling">graphics-performance-profiling</a><button aria-label="打开/收起侧边栏菜单「graphics-performance-profiling」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/lighting-overview">lighting-overview</a><button aria-label="打开/收起侧边栏菜单「lighting-overview」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/materials">materials</a><button aria-label="打开/收起侧边栏菜单「materials」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/mesh">mesh</a><button aria-label="打开/收起侧边栏菜单「mesh」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/models">models</a><button aria-label="打开/收起侧边栏菜单「models」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/docs/render-pipelines">render-pipelines</a><button aria-label="打开/收起侧边栏菜单「render-pipelines」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/render-pipelines/best-practice-lighting-pipelines">选择和配置渲染管线和光照解决方案</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/docs/built-in-render-pipeline">built-in-render-pipeline</a><button aria-label="打开/收起侧边栏菜单「built-in-render-pipeline」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/docs/built-in-shader-examples">built-in-shader-examples</a><button aria-label="打开/收起侧边栏菜单「built-in-shader-examples」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-shader-examples/built-in-shader-examples-vertex-data">可视化顶点数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/built-in-shader-examples/sl-vertex-fragment-shader-examples">自定义着色器基础</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-render-pipeline/graphics-command-buffers">使用 CommandBuffer 来扩展内置渲染管线</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-render-pipeline/graphics-tiers">Graphics tiers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/built-in-render-pipeline/render-tech-hardware-requirements">内置渲染管线的硬件要求</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/rendering-paths">rendering-paths</a><button aria-label="打开/收起侧边栏菜单「rendering-paths」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/render-pipelines/high-definition-render-pipeline">使用高清渲染管线资源</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/render-pipelines/render-pipelines-feature-comparison">Render pipeline feature comparison</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/render-pipelines/render-pipelines-overview">渲染管线简介</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/scriptable-render-pipeline">scriptable-render-pipeline</a><button aria-label="打开/收起侧边栏菜单「scriptable-render-pipeline」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/srp-custom">srp-custom</a><button aria-label="打开/收起侧边栏菜单「srp-custom」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/render-pipelines/srp-setting-render-pipeline-asset">How to get, set, and configure the active render pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/render-pipelines/universal-render-pipeline">使用通用渲染管线</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/shaders">shaders</a><button aria-label="打开/收起侧边栏菜单「shaders」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/sky">sky</a><button aria-label="打开/收起侧边栏菜单「sky」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/textures">textures</a><button aria-label="打开/收起侧边栏菜单「textures」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docs/visual-effects">visual-effects</a><button aria-label="打开/收起侧边栏菜单「visual-effects」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/input">input</a><button aria-label="打开/收起侧边栏菜单「input」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/legacy-topics">legacy-topics</a><button aria-label="打开/收起侧边栏菜单「legacy-topics」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/navigation">navigation</a><button aria-label="打开/收起侧边栏菜单「navigation」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/open-source-repositories">open-source-repositories</a><button aria-label="打开/收起侧边栏菜单「open-source-repositories」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/packages-list">packages-list</a><button aria-label="打开/收起侧边栏菜单「packages-list」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/physics-section">physics-section</a><button aria-label="打开/收起侧边栏菜单「physics-section」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/platform-specific">platform-specific</a><button aria-label="打开/收起侧边栏菜单「platform-specific」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/scripting-section">scripting-section</a><button aria-label="打开/收起侧边栏菜单「scripting-section」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/search-overview">search-overview</a><button aria-label="打开/收起侧边栏菜单「search-overview」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/uitoolkits">uitoolkits</a><button aria-label="打开/收起侧边栏菜单「uitoolkits」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/unet">unet</a><button aria-label="打开/收起侧边栏菜单「unet」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/unity-manual">unity-manual</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/unity-overview">unity-overview</a><button aria-label="打开/收起侧边栏菜单「unity-overview」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/unity-services">unity-services</a><button aria-label="打开/收起侧边栏菜单「unity-services」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/unity2d">unity2d</a><button aria-label="打开/收起侧边栏菜单「unity2d」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/video-player">video-player</a><button aria-label="打开/收起侧边栏菜单「video-player」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docs/xr">xr</a><button aria-label="打开/收起侧边栏菜单「xr」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/graphics">graphics</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/render-pipelines">render-pipelines</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/built-in-render-pipeline">built-in-render-pipeline</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/built-in-shader-examples">built-in-shader-examples</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/built-in-shader-examples/sl-vertex-fragment-shader-examples">自定义着色器基础</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>自定义着色器基础</h1><p>这些内置渲染管线的着色器示例演示了编写自定义着色器的基础知识，并涵盖了常见的用例。</p><p>有关编写着色器的信息，请参阅<!-- -->[编写着色器][1]<!-- -->。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="设置场景">设置场景<a class="hash-link" href="#设置场景" title="标题的直接链接">​</a></h3><p>第一步是创建一些用于测试着色器的对象。在主菜单中选择  <strong>Game Object</strong>  <!-- -->&gt;<!-- -->  <strong>3D Object</strong>  <!-- -->&gt;<!-- -->  <strong>Capsule</strong> 。然后，调整摄像机位置，使其显示胶囊体。在 Hierarchy 视图中双击胶囊体 (Capsule) 以将 Scene 视图聚焦在该胶囊体上，然后选择主摄像机 (Main Camera) 对象，并单击主菜单中的  <strong>Game object</strong>  <!-- -->&gt;<!-- -->  <strong>Align with View</strong> 。</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/SL-CapsuleSetup.png" alt="SL-CapsuleSetup.png"></p><p>在 Project 视图中，从菜单中选择  <strong>Create</strong>  <!-- -->&gt;<!-- --> <!-- -->_<em>Material **，创建新的<!-- -->[材质][2]<!-- -->。Project 视图中将显示一个名为</em> New Material<!-- -->_<!-- --> 的新材质。</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/SL-NewMaterial.png" alt="SL-NewMaterial.png"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="创建着色器">创建着色器<a class="hash-link" href="#创建着色器" title="标题的直接链接">​</a></h3><p>现在以类似方式创建一个新的<!-- -->[着色器][3]<!-- -->资源。在 Project 视图中，从菜单中选择<strong> Create </strong>&gt;<strong> Shader </strong>&gt;<strong> Unlit Shader </strong>。 随后将创建一个基本着色器，该着色器仅显示一个纹理，无任何光照。</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/SL-NewShader.png" alt="SL-NewShader.png"><strong> Create </strong>&gt;<strong> Shader </strong>菜单中的其他条目将创建基本要素着色器 或其他类型，例如，基本<!-- -->[表面着色器][4]<!-- -->。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="链接网格材质和着色器">链接网格、材质和着色器<a class="hash-link" href="#链接网格材质和着色器" title="标题的直接链接">​</a></h3><p>通过材质的检视面板使材质使用着色器，或者在 Project 视图中将着色器资源拖动到材质资源上。材质检视面板在使用此着色器时将显示白色球体。</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/SL-SelectShaderMenu.png" alt="SL-SelectShaderMenu.png"></p><p>现在将材质拖动到 Scene 或 Hierarchy 视图中的网格对象上。或者，选择对象，并在检视面板中使其使用<!-- -->[网格渲染器 (Mesh Renderer)][5]<!-- --> 组件的 Materials 字段中的材质。</p><p><img src="https://docs.unity3d.com/cn/2022.1/uploads/Main/SL-WhiteCapsuleUnlitShader.png" alt="SL-WhiteCapsuleUnlitShader.png"></p><p>完整这些设置后，现在可以开始查看着色器代码，并会在 Scene 视图中看到对胶囊体上着色器所做的更改的结果。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="着色器的主要部分">着色器的主要部分<a class="hash-link" href="#着色器的主要部分" title="标题的直接链接">​</a></h2><p>要开始检查着色器的代码，请在 Project 视图中双击着色器资源。着色器代码将在脚本编辑器（MonoDevelop 或 Visual Studio）中打开。</p><p>着色器最开始的代码如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Shader &quot;Unlit/NewUnlitShader&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SubShader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tags { &quot;RenderType&quot;=&quot;Opaque&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LOD 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CGPROGRAM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #pragma vertex vert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #pragma fragment frag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使雾生效</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #pragma multi_compile_fog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #include &quot;UnityCG.cginc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            struct appdata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float4 vertex : POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float2 uv : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            struct v2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float2 uv : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                UNITY_FOG_COORDS(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float4 vertex : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sampler2D _MainTex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 _MainTex_ST;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f vert (appdata v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                o.vertex = UnityObjectToClipPos(v.vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                o.uv = TRANSFORM_TEX(v.uv, _MainTex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                UNITY_TRANSFER_FOG(o,o.vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 对纹理进行采样</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                fixed4 col = tex2D(_MainTex, i.uv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 应用雾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                UNITY_APPLY_FOG(i.fogCoord, col);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return col;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>这个初始着色器看上去不是那么简单！但不要担心， 我们将逐步介绍每个部分。</p><p>让我们看看这个简单着色器的主要部分。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Shader</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>[Shader][6]<!-- --> 命令包含一个带有 着色器名称的字符串。在<!-- -->[材质][7]<!-- -->检视面板中选择着色器时，可以使用正斜杠字符“/”将着色器放置在子菜单中。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">属性</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>[Properties][8]<!-- --> 代码块包含着色器变量 （纹理、颜色等），这些变量将保存为材质的一部分， 并显示在材质检视面板中。在我们的无光照着色器模板中， 声明了单个纹理属性。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">SubShader</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>一个着色器 (Shader) 可以包含一个或多个<!-- -->[子着色器 (SubShader)][9]<!-- -->，主要 用于实现不同 GPU 功能的着色器。 在本教程中，我们并不太关心这一点，所以我们 所有的着色器都只包含一个子着色器。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Pass</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>每个子着色器由多个<!-- -->[通道][10]<!-- -->组成，每个通道代表 为使用着色器材质渲染的同一对象执行 顶点和片元代码。 许多简单的着色器只使用一个通道，但与光照交互的 着色器可能需要更多通道（有关详细信息，请参阅 <!-- -->[光照管线][11]<!-- -->）。通道内部的 命令通常设置固定函数状态，例如 混合模式。</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">CGPROGRAM ..ENDCG</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>这些关键字包裹着顶点和片元着色器中的 HLSL 代码 部分。通常，大多数相关代码都包含在这里。有关详细信息，请参阅 <!-- -->[顶点和片元着色器][12]<!-- -->。</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="简单的无光照着色器">简单的无光照着色器<a class="hash-link" href="#简单的无光照着色器" title="标题的直接链接">​</a></h2><p>无光照着色器模板比显示带纹理的对象 绝对需要更多的代码。例如， 它支持雾效，以及材质中的纹理平铺/偏移字段。 让我们最大程度简化着色器，并添加更多注释：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Shader &quot;Unlit/SimpleUnlitTexturedShader&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 我们已删除对纹理平铺/偏移的支持，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 因此请让它们不要显示在材质检视面板中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [NoScaleOffset] _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SubShader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CGPROGRAM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使用 &quot;vert&quot; 函数作为顶点着色器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #pragma vertex vert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使用 &quot;frag&quot; 函数作为像素（片元）着色器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #pragma fragment frag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 顶点着色器输入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            struct appdata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float4 vertex : POSITION; // 顶点位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float2 uv : TEXCOORD0; // 纹理坐标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 顶点着色器输出（&quot;顶点到片元&quot;）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            struct v2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float2 uv : TEXCOORD0; // 纹理坐标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                float4 vertex : SV_POSITION; // 裁剪空间位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 顶点着色器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f vert (appdata v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 将位置转换为裁剪空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                //（乘以模型*视图*投影矩阵）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                o.vertex = mul(UNITY_MATRIX_MVP, v.vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 仅传递纹理坐标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                o.uv = v.uv;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 我们将进行采样的纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sampler2D _MainTex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 像素着色器；返回低精度（&quot;fixed4&quot; 类型）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 颜色（&quot;SV_Target&quot; 语义）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 对纹理进行采样并将其返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                fixed4 col = tex2D(_MainTex, i.uv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return col;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```** 顶点着色器 **是对 3D 模型的每个顶点运行的程序。通常情况下，它并不做任何特别有趣的事情。这里我们只是将顶点位置从对象空间转换为所谓的“裁剪空间”（由 GPU 用于栅格化屏幕上的对象）。我们还传递未修改的输入纹理坐标；我们需要该坐标来对片元着色器中的纹理进行采样。** 片元着色器 **是对屏幕上对象占据的每个像素运行的程序，通常用于计算和输出每个像素的颜色。通常，屏幕上有数百万个像素，并且片元着色器将 针对所有像素执行！优化片元着色器是整体游戏性能优化工作的重要组成部分。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">一些变量或函数定义后跟一个** 语义指示符 **，例如** : POSITION **或** : SV\_Target **。这些语义指示符将这些变量的“含义”传达给 GPU。有关详细信息，请参阅[着色器语义][13]页面。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">用于具有良好纹理的良好模型时，我们的简单着色器看起来非常好！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleUnlitTextured.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleUnlitTextured.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 更简单的单色着色器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">让我们进一步简化着色器：我们将制作一个用单一颜色绘制整个对象的 着色器。这并不是很有用，但别忘了，我们是在学习。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/SingleColor&quot;
{
Properties
{
// 材质检视面板的颜色属性，默认为白色
_Color (&quot;Main Color&quot;, Color) = (1,1,1,1)
}
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        // 顶点着色器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 这次不使用 &quot;appdata&quot; 结构，仅手动拼写输入，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 并且不返回 v2f 结构，同样仅返回单个输出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // float4 裁剪位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        float4 vert (float4 vertex : POSITION) : SV_POSITION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return mul(UNITY_MATRIX_MVP, vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 来自材质的颜色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 _Color;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 像素着色器，无需输入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag () : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return _Color; // 仅将其返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">这次，着色器函数只是手动拼出输入，而不是使用输入结构 (** appdata **) 和输出结构 (** v2f **)。两种方式都有效，选择使用哪种方式取决于您编写代码的风格和偏好。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleSingleColor.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleSingleColor.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 使用网格法线，轻松获利</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">让我们继续了解在世界空间中显示网格法线的着色器。言归正传：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/WorldSpaceNormals&quot;
{
// 这次没有 Properties 代码块！
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
// 包含 UnityObjectToWorldNormal helper 函数的 include 文件
#include &quot;UnityCG.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 我们将输出世界空间法线作为常规 (&quot;texcoord&quot;) 插值器之一</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldNormal : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 pos : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 顶点着色器：将对象空间法线也作为输入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (float4 vertex : POSITION, float3 normal : NORMAL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.pos = UnityObjectToClipPos(vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // UnityCG.cginc 文件包含将法线从对象变换到</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 世界空间的函数，请使用该函数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.worldNormal = UnityObjectToWorldNormal(normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 c = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 法线是具有 xyz 分量的 3D 矢量；处于 -1..1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 范围。要将其显示为颜色，请将此范围设置为 0..1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 并放入红色、绿色、蓝色分量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c.rgb = i.worldNormal*0.5+0.5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleWorldSpaceNormals.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleWorldSpaceNormals.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">除了产生漂亮的颜色外，法线还用于各种图形效果：光照、反射、轮廓等。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在上面的着色器中，我们开始使用 Unity 的内置[着色器 include 文件][14]之一。 这里使用的** UnityCG.cginc **包含一个方便的函数** UnityObjectToWorldNormal **。我们还使用了实用函数** UnityObjectToClipPos **，该函数将顶点从对象空间转换为屏幕。这使得代码更易于阅读，并且在某些情况下更有效。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">在所谓的“插值器”（有时称为“变化”）中，我们已经看到数据可从顶点传入片元着色器。在 HLSL 着色语言中，它们通常用** TEXCOORDn **语义进行标记，其中每一个最多可以是一个 4 分量矢量（有关详细信息，请参阅[语义][15]页面）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">此外，我们学习了如何使用一种简单的技术将标准化矢量（在 –1.0 到 +1.0 范围内）可视化为颜色：只需将它们乘以二分之一并加二分之一。有关更多顶点数据可视化示例，请参阅[可视化顶点数据][16]。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 使用世界空间法线的环境反射</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">如果在场景中使用[天空盒][17]作为反射源（请参阅 [Lighting 窗口][18]）， 基本上会创建一个包含天空盒数据的“默认”[反射探针][19]。 反射探针内部是[立方体贴图][20]纹理；我们将扩展上面的世界空间法线着色器来对其进行深入了解。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">代码现在开始变得有点复杂。当然，如果您希望着色器能够自动处理光源、阴影、反射以及光照系统的其余部分，使用[表面着色器][21]会容易得多。此示例旨在向您展示如何以“手动”方式使用光照系统的各个部分。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/SkyReflection&quot;
{
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldRefl : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 pos : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (float4 vertex : POSITION, float3 normal : NORMAL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.pos = UnityObjectToClipPos(vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 计算顶点的世界空间位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float3 worldPos = mul(_Object2World, vertex).xyz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 计算世界空间视图方向</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float3 worldViewDir = normalize(UnityWorldSpaceViewDir(worldPos));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 世界空间法线</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float3 worldNormal = UnityObjectToWorldNormal(normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 世界空间反射矢量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.worldRefl = reflect(-worldViewDir, worldNormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使用反射矢量对默认反射立方体贴图进行采样</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half4 skyData = UNITY_SAMPLE_TEXCUBE(unity_SpecCube0, i.worldRefl);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 将立方体贴图数据解码为实际颜色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 skyColor = DecodeHDR (skyData, unity_SpecCube0_HDR);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 将其输出！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 c = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c.rgb = skyColor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleSkyReflection.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleSkyReflection.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">以上示例使用了内置[着色器 include 文件][22]中的部分内容：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-   来自[内置着色器变量][23]的** unity\_SpecCube0 **、** unity\_SpecCube0\_HDR **、** Object2World **和** UNITY\_MATRIX\_MVP **。** unity\_SpecCube0 **包含激活的反射探针的数据。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-** UNITY\_SAMPLE\_TEXCUBE **是一个用于采样立方体贴图的[内置宏][24]。通常使用标准 HLSL 语法声明和 使用大多数常规立方体贴图（** samplerCUBE **和** texCUBE **），但 Unity 中的反射探针立方体贴图以特殊方式声明以节省采样器字段。如果您不知道这是什么，请不要担心，只需要知道：要使用**  unity\_SpecCube0 **立方体贴图，必须使用** UNITY\_SAMPLE\_TEXCUBE **宏。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-** UnityCG.cginc **中的** UnityWorldSpaceViewDir **函数以及来自同一文件的** DecodeHDR **函数。后者用于从反射探针数据中获取实际颜色（因为 Unity 以特殊编码方式存储反射探针立方体贴图）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-** reflect **只是一个内置的 HLSL 函数，用于计算给定法线周围的矢量反射。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 使用法线贴图的环境反射</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">通常，** 法线贴图 **用于在对象上创建其他细节，而无需创建其他几何体。让我们看看如何使用法线贴图纹理制作发射环境的着色器。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">现在开始*真正涉及到了*数学知识，所以我们将分几步完成。在上面的着色器中，反射 方向是按每个顶点计算的（在顶点着色器中），片元着色器仅执行反射探针 立方体贴图查找。然而，一旦我们开始使用法线贴图，表面法线本身需要按每个像素计算，这意味着我们还必须按每个像素计算环境的反射方式！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">首先，让我们重写上面的着色器来实现相同效果，只是我们将一些计算移到片元着色器，从而按每个像素进行计算：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/SkyReflection Per Pixel&quot;
{
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float3 worldPos : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldNormal : TEXCOORD1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 pos : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (float4 vertex : POSITION, float3 normal : NORMAL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.pos = UnityObjectToClipPos(vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.worldPos = mul(_Object2World, vertex).xyz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.worldNormal = UnityObjectToWorldNormal(normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 计算视图方向和反射矢量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 此处为每像素计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldViewDir = normalize(UnityWorldSpaceViewDir(i.worldPos));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldRefl = reflect(-worldViewDir, i.worldNormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 与在先前的着色器中相同</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half4 skyData = UNITY_SAMPLE_TEXCUBE(unity_SpecCube0, worldRefl);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 skyColor = DecodeHDR (skyData, unity_SpecCube0_HDR);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 c = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c.rgb = skyColor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">这里并没有带给我们太多不同：着色器看起来完全相同，只是它现在运行得更慢，因为它对屏幕上的每个像素进行更多的计算，而不是仅对每个模型的顶点进行计算。但是，我们很快就会真正需要这些计算。更高的图形保真度通常需要更复杂的着色器。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">我们现在也要学习新东西，即所谓的“切线空间”。法线贴图纹理通常在坐标空间中表示，可将其视为“跟随模型表面”。在我们的着色器中，我们需要知道切线空间基矢量，从纹理中读取法线矢量，将其转换为世界空间，然后通过上面的着色器 进行所有数学运算。我们行动吧！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/SkyReflection Per Pixel&quot;
{
Properties {
// 材质上的法线贴图纹理，
// 默认为虚拟的 &quot;平面表面&quot; 法线贴图
_BumpMap(&quot;Normal Map&quot;, 2D) = &quot;bump&quot; {}
}
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float3 worldPos : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 这三个矢量将保持一个 3x3 旋转矩阵，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 此矩阵进行从切线到世界空间的转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tspace0 : TEXCOORD1; // tangent.x, bitangent.x, normal.x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tspace1 : TEXCOORD2; // tangent.y, bitangent.y, normal.y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tspace2 : TEXCOORD3; // tangent.z, bitangent.z, normal.z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 法线贴图的纹理坐标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 uv : TEXCOORD4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 pos : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 顶点着色器现在还需要每顶点切线矢量。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 在 Unity 中，切线为 4D 矢量，其中使用 .w 分量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 指示双切线矢量的方向。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 我们还需要纹理坐标。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (float4 vertex : POSITION, float3 normal : NORMAL, float4 tangent : TANGENT, float2 uv : TEXCOORD0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.pos = UnityObjectToClipPos(vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.worldPos = mul(_Object2World, vertex).xyz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 wNormal = UnityObjectToWorldNormal(normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 wTangent = UnityObjectToWorldDir(tangent.xyz);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 从法线和切线的交叉积计算双切线</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half tangentSign = tangent.w * unity_WorldTransformParams.w;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 wBitangent = cross(wNormal, wTangent) * tangentSign;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 输出切线空间矩阵</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.tspace0 = half3(wTangent.x, wBitangent.x, wNormal.x);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.tspace1 = half3(wTangent.y, wBitangent.y, wNormal.y);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.tspace2 = half3(wTangent.z, wBitangent.z, wNormal.z);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.uv = uv;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 来自着色器属性的法线贴图纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _BumpMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 对法线贴图进行采样，并根据 Unity 编码进行解码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tnormal = UnpackNormal(tex2D(_BumpMap, i.uv));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 将法线从切线变换到世界空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldNormal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            worldNormal.x = dot(i.tspace0, tnormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            worldNormal.y = dot(i.tspace1, tnormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            worldNormal.z = dot(i.tspace2, tnormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 与在先前的着色器中处于相同的位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldViewDir = normalize(UnityWorldSpaceViewDir(i.worldPos));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldRefl = reflect(-worldViewDir, worldNormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half4 skyData = UNITY_SAMPLE_TEXCUBE(unity_SpecCube0, worldRefl);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 skyColor = DecodeHDR (skyData, unity_SpecCube0_HDR);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 c = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c.rgb = skyColor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">哎呦，这个非常复杂。但是，看看法线贴图反射！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleSkyReflectionNormalmap.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleSkyReflectionNormalmap.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 添加更多纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">让我们为上面的法线贴图、天空反射着色器添加更多纹理。我们将添加基础颜色纹理（如第一个无光照的示例中所示）和遮挡贴图来使洞穴变暗。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/More Textures&quot;
{
Properties {
// 我们将在材质中使用三种纹理
_MainTex(&quot;Base texture&quot;, 2D) = &quot;white&quot; {}
_OcclusionMap(&quot;Occlusion&quot;, 2D) = &quot;white&quot; {}
_BumpMap(&quot;Normal Map&quot;, 2D) = &quot;bump&quot; {}
}
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        // 与在先前的着色器中完全相同</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float3 worldPos : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tspace0 : TEXCOORD1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tspace1 : TEXCOORD2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tspace2 : TEXCOORD3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 uv : TEXCOORD4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 pos : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (float4 vertex : POSITION, float3 normal : NORMAL, float4 tangent : TANGENT, float2 uv : TEXCOORD0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.pos = UnityObjectToClipPos(vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.worldPos = mul(_Object2World, vertex).xyz;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 wNormal = UnityObjectToWorldNormal(normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 wTangent = UnityObjectToWorldDir(tangent.xyz);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half tangentSign = tangent.w * unity_WorldTransformParams.w;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 wBitangent = cross(wNormal, wTangent) * tangentSign;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.tspace0 = half3(wTangent.x, wBitangent.x, wNormal.x);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.tspace1 = half3(wTangent.y, wBitangent.y, wNormal.y);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.tspace2 = half3(wTangent.z, wBitangent.z, wNormal.z);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.uv = uv;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 来自着色器属性的纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _MainTex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _OcclusionMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _BumpMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 与在先前的着色器中相同...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 tnormal = UnpackNormal(tex2D(_BumpMap, i.uv));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldNormal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            worldNormal.x = dot(i.tspace0, tnormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            worldNormal.y = dot(i.tspace1, tnormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            worldNormal.z = dot(i.tspace2, tnormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldViewDir = normalize(UnityWorldSpaceViewDir(i.worldPos));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldRefl = reflect(-worldViewDir, worldNormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half4 skyData = UNITY_SAMPLE_TEXCUBE(unity_SpecCube0, worldRefl);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 skyColor = DecodeHDR (skyData, unity_SpecCube0_HDR);                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 c = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c.rgb = skyColor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使用基本纹理和遮挡贴图调制天空颜色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed3 baseColor = tex2D(_MainTex, i.uv).rgb;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed occlusion = tex2D(_OcclusionMap, i.uv).r;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c.rgb *= baseColor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c.rgb *= occlusion;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">气球猫看起来很不错！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleMoreTextures.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleMoreTextures.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 纹理化着色器示例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 程序化棋盘图案</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">下面的着色器根据网格的纹理坐标输出棋盘图案：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/Checkerboard&quot;
{
Properties
{
_Density (&quot;Density&quot;, Range(2,50)) = 30
}
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 uv : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 vertex : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        float _Density;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (float4 pos : POSITION, float2 uv : TEXCOORD0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.vertex = UnityObjectToClipPos(pos);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.uv = uv * _Density;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 c = i.uv;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c = floor(c) / 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float checker = frac(c.x + c.y) * 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return checker;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Properties][25] 代码块中的密度滑动条控制棋盘的密集程度。在顶点着色器中，网格 UV 与密度值相乘，使它们从 0 到 1 的范围变为 0 到密度的范围。假设密度设置为 30，这将使片元着色器中的** i.uv **输入包含 0 到 30 的浮点值，对应于正在渲染的网格的各个位置。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">然后，片元着色器代码仅使用 HLSL 的内置** floor **函数获取输入坐标的整数部分，并将其除以 2。回想一下，输入坐标是从 0 到 30 的数字；这使得它们都被“量化”为 0、0.5、1、1.5、2、2.5 等等的值。输入坐标的 x 和 y 分量都完成了此操作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">接下来，我们将这些 x 和 y 坐标相加（每个坐标的可能值只有 0、0.5、1、1.5 等等），并且只使用另一个内置的 HLSL 函数** frac **来获取小数部分。结果只能是 0.0 或 0.5。然后，我们将它乘以 2 使其为 0.0 或 1.0，并输出为颜色（这分别产生黑色或白色）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleCheckerboard.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleCheckerboard.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 三面纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">对于复杂网格或程序化网格，不使用常规 UV 坐标对它们进行纹理化，有时只需在三个主方向将纹理“投影”到对象上即可。这称为“三面”纹理。这个想法是使用表面法线来加权三个纹理方向。下面是着色器：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Unlit/Triplanar&quot;
{
Properties
{
_MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; {}
_Tiling (&quot;Tiling&quot;, Float) = 1.0
_OcclusionMap(&quot;Occlusion&quot;, 2D) = &quot;white&quot; {}
}
SubShader
{
Pass
{
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 objNormal : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float3 coords : TEXCOORD1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 uv : TEXCOORD2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 pos : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        float _Tiling;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (float4 pos : POSITION, float3 normal : NORMAL, float2 uv : TEXCOORD0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.pos = UnityObjectToClipPos(pos);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.coords = pos.xyz * _Tiling;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.objNormal = normal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.uv = uv;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _MainTex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _OcclusionMap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 使用法线的绝对值作为纹理权重</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 blend = abs(i.objNormal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 确保权重之和为 1（除以 x+y+z 之和）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            blend /= dot(blend,1.0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 针对 x、y、z 轴读取三个纹理投影</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 cx = tex2D(_MainTex, i.coords.yz);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 cy = tex2D(_MainTex, i.coords.xz);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 cz = tex2D(_MainTex, i.coords.xy);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 根据权重混合纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 c = cx * blend.x + cy * blend.y + cz * blend.z;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 根据常规遮挡贴图进行调制</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c *= tex2D(_OcclusionMap, i.uv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleTriPlanar.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleTriPlanar.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 光照计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">通常，当您需要适用于 Unity 光照管线的着色器时， 可以编写[表面着色器][26]。这样会为您完成大部分“繁重的工作”， 您的着色器代码只需要定义表面属性。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但在某些情况下，您希望绕过标准表面着色器路径； 或者是出于性能原因，您只想支持整个光照管线的某个有限子集， 或者您想要进行“标准光照”以外的自定义。以下示例 将说明如何从手动编写的顶点和片元着色器获取光照数据。 查看表面着色器生成的代码（通过[着色器检视面板][27]）也是一种 很好的学习资源。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 简单的漫射光照</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">我们需要做的第一件事就是指出我们的着色器确实需要传递给它的光照信息。Unity 的[渲染管线][28]支持各种渲染方式；这里我们将使用默认的[前向渲染][29]。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">我们首先只支持一个方向光。Unity 中的前向渲染的工作方式是在一个名为** ForwardBase **的单个通道中渲染主方向光、环境光、光照贴图和反射。在着色器中，通过添加以下[通道标签][30]来指示这一情况：** Tags {“LightMode”=“ForwardBase”} **。这将使方向光数据通过一些[内置变量][31]传入着色器。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">以下着色器为每个顶点计算简单漫射光照，并使用单个主纹理：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Lit/Simple Diffuse&quot;
{
Properties
{
<!-- -->[NoScaleOffset]<!-- --> _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; {}
}
SubShader
{
Pass
{
// 指示我们的通道是前向渲染管线中的
// &quot;基础&quot; 通道。它可设置环境光和主
// 方向光数据；光线方向为 _WorldSpaceLightPos0
// 而颜色为 _LightColor0
Tags {&quot;LightMode&quot;=&quot;ForwardBase&quot;}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        CGPROGRAM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma vertex vert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma fragment frag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #include &quot;UnityCG.cginc&quot; // 对于 UnityObjectToWorldNormal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #include &quot;UnityLightingCommon.cginc&quot; // 对于 _LightColor0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 uv : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 diff : COLOR0; // 漫射光照颜色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 vertex : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (appdata_base v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.vertex = UnityObjectToClipPos(v.vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.uv = v.texcoord;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 在世界空间中获取顶点法线</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldNormal = UnityObjectToWorldNormal(v.normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 标准漫射（兰伯特）光照的法线和</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 光线方向之间的点积</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half nl = max(0, dot(worldNormal, _WorldSpaceLightPos0.xyz));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 考虑浅色因素</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.diff = nl * _LightColor0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _MainTex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 样本纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 col = tex2D(_MainTex, i.uv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 乘以光照</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            col *= i.diff;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return col;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">这使得对象对光线方向作出反应：面向光源的部分获得光照，而背向的部分完全没有光照。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleDiffuseLighting.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleDiffuseLighting.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 带环境光的漫射光照</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">上面的示例不考虑任何环境光照或光照探针。我们来解决这个问题！ 事实证明，我们可以通过添加一行代码来实现这一目标。环境光和[光照探针][32]数据都以球谐函数形式传递给着色器，** UnityCG.cginc **[include 文件][33] 中的** ShadeSH9 **函数在给定世界空间法线的情况下完成所有估算工作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Lit/Diffuse With Ambient&quot;
{
Properties
{
<!-- -->[NoScaleOffset]<!-- --> _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; {}
}
SubShader
{
Pass
{
Tags {&quot;LightMode&quot;=&quot;ForwardBase&quot;}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        CGPROGRAM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma vertex vert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma fragment frag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #include &quot;UnityCG.cginc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #include &quot;UnityLightingCommon.cginc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 uv : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 diff : COLOR0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 vertex : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (appdata_base v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.vertex = UnityObjectToClipPos(v.vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.uv = v.texcoord;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldNormal = UnityObjectToWorldNormal(v.normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half nl = max(0, dot(worldNormal, _WorldSpaceLightPos0.xyz));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.diff = nl * _LightColor0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 与先前着色器的唯一区别：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 除了来自主光源的漫射光照，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 还可添加来自环境或光照探针的光照</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 来自 UnityCG.cginc 的 ShadeSH9 函数使用世界空间法线</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 对其进行估算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.diff.rgb += ShadeSH9(half4(worldNormal,1));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _MainTex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 col = tex2D(_MainTex, i.uv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            col *= i.diff;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return col;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">事实上，这个着色器开始看起来非常类似于内置的[旧版漫射][34]着色器！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleDiffuseAmbientLighting.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleDiffuseAmbientLighting.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 实现阴影投射</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">我们的着色器目前既不能接受也不能投射阴影。让我们先实现阴影投射。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">为了投射阴影，着色器必须在其任何[子着色器][35]或任何[回退][36]中具有** ShadowCaster **[通道类型][37]。ShadowCaster 通道用于将对象渲染到阴影贴图中，通常它非常简单：顶点着色器只需要估算顶点位置，片元着色器几乎不执行任何操作。阴影贴图只是深度缓冲区，因此即使是片元着色器输出的颜色也无关紧要。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">这意味着对于许多着色器，阴影投射物通道几乎完全相同（除非对象具有基于自定义顶点着色器的变形，或者具有 Alpha 镂空/半透明部分）。最简单的捕捉方法是使用着色器命令 [UsePass][38]：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Pass
{
// 常规光照通道
}
// 通过 VertexLit 内置着色器捕捉阴影投射物
UsePass &quot;Legacy Shaders/VertexLit/SHADOWCASTER&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">但我们在这里是为了学习，所以让我们通过“手动”方式实现相同效果。为了缩短代码长度， 我们已经将光照通道 (“ForwardBase”) 替换为仅执行无纹理环境光的代码。在它下面，有一个“ShadowCaster”通道，让对象能够支持阴影投射。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Lit/Shadow Casting&quot;
{
SubShader
{
// 非常简单的光照通道，仅处理非纹理环境
Pass
{
Tags {&quot;LightMode&quot;=&quot;ForwardBase&quot;}
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;
struct v2f
{
fixed4 diff : COLOR0;
float4 vertex : SV_POSITION;
};
v2f vert (appdata_base v)
{
v2f o;
o.vertex = UnityObjectToClipPos(v.vertex);
half3 worldNormal = UnityObjectToWorldNormal(v.normal);
// 仅估算环境光
o.diff.rgb = ShadeSH9(half4(worldNormal,1));
o.diff.a = 1;
return o;
}
fixed4 frag (v2f i) : SV_Target
{
return i.diff;
}
ENDCG
}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    // 阴影投射物渲染通道，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 使用 UnityCG.cginc 中的宏手动实现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tags {&quot;LightMode&quot;=&quot;ShadowCaster&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CGPROGRAM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma vertex vert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma fragment frag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma multi_compile_shadowcaster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #include &quot;UnityCG.cginc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            V2F_SHADOW_CASTER;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert(appdata_base v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            TRANSFER_SHADOW_CASTER_NORMALOFFSET(o)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        float4 frag(v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SHADOW_CASTER_FRAGMENT(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">现在下方有一个平面，使用常规的内置漫射着色器，因此我们可以看到 我们的阴影生效（请记住，我们当前的着色器还不支持\_接受\_阴影！）。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleShadowCasting.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleShadowCasting.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">我们使用了** #pragma multi\_compile\_shadowcaster **指令。这会导致着色器被编译为多个变体，并为每个变体定义了不同的预处理器宏（有关详细信息，请参阅 [多个着色器变体][39]页面）。渲染到阴影贴图时，点光源与其他光源类型需要着色器代码略有不同，这就是需要此指令的原因。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#### 接受阴影</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Implementing support for receiving shadows will require compiling the base lighting pass into several variants, to handle cases of “directional light without shadows” and “directional light with shadows” properly.** #pragma multi\_compile\_fwdbase **directive does this (see [multiple shader variants][40] for details). In fact it does a lot more: it also compiles variants for the different lightmap types, Enlighten Realtime Global Illumination being on or off etc. Currently we don’t need all that, so we’ll explicitly skip these variants.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">然后，为了获得实际的阴影计算，我们将** #include “AutoLight.cginc”** 着色器的 [include 文件][41] 并使用该文件中的 SHADOW\_COORDS、TRANSFER\_SHADOW 和 SHADOW\_ATTENUATION 宏。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">下面是着色器：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Lit/Diffuse With Shadows&quot;
{
Properties
{
<!-- -->[NoScaleOffset]<!-- --> _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; {}
}
SubShader
{
Pass
{
Tags {&quot;LightMode&quot;=&quot;ForwardBase&quot;}
CGPROGRAM
#pragma vertex vert
#pragma fragment frag
#include &quot;UnityCG.cginc&quot;
#include &quot;Lighting.cginc&quot;</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        // 将着色器编译成多个有阴影和没有阴影的变体</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //（我们还不关心任何光照贴图，所以跳过这些变体）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma multi_compile_fwdbase nolightmap nodirlightmap nodynlightmap novertexlight</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 阴影 helper 函数和宏</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #include &quot;AutoLight.cginc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        struct v2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float2 uv : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SHADOW_COORDS(1) // 将阴影数据放入 TEXCOORD1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed3 diff : COLOR0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed3 ambient : COLOR1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 pos : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        v2f vert (appdata_base v)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v2f o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.pos = UnityObjectToClipPos(v.vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.uv = v.texcoord;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half3 worldNormal = UnityObjectToWorldNormal(v.normal);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            half nl = max(0, dot(worldNormal, _WorldSpaceLightPos0.xyz));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.diff = nl * _LightColor0.rgb;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.ambient = ShadeSH9(half4(worldNormal,1));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 计算阴影数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            TRANSFER_SHADOW(o)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sampler2D _MainTex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag (v2f i) : SV_Target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 col = tex2D(_MainTex, i.uv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 计算阴影衰减（1.0 = 完全照亮，0.0 = 完全阴影）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed shadow = SHADOW_ATTENUATION(i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 用阴影使光照变暗，保持环境不变</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed3 lighting = i.diff * shadow + i.ambient;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            col.rgb *= lighting;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return col;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 阴影投射支持</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UsePass &quot;Legacy Shaders/VertexLit/SHADOWCASTER&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">看看，现在我们实现了阴影！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">![ExampleShadowReceiving.png](https://docs.unity3d.com/cn/2022.1/uploads/SL/ExampleShadowReceiving.png)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 其他着色器示例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Fog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>Shader &quot;Custom/TextureCoordinates/Fog&quot; {
SubShader {
Pass {
CGPROGRAM
#pragma vertex vert
#pragma fragment frag</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        //编译雾效变化时需要。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #pragma multi_compile_fog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #include &quot;UnityCG.cginc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        struct vertexInput {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 vertex : POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 texcoord0 : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        struct fragmentInput{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 position : SV_POSITION;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            float4 texcoord0 : TEXCOORD0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //用于传递雾量，数字应为自由纹理坐标值。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            UNITY_FOG_COORDS(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fragmentInput vert(vertexInput i){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fragmentInput o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.position = UnityObjectToClipPos(i.vertex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            o.texcoord0 = i.texcoord0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //从裁剪空间位置计算雾量。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            UNITY_TRANSFER_FOG(o,o.position);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return o;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fixed4 frag(fragmentInput i) : SV_Target {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fixed4 color = fixed4(i.texcoord0.xy,0,0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //应用雾效（自动处理附加通道）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            UNITY_APPLY_FOG(i.fogCoord, color); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //处理可能的另一种自定义雾效颜色选项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //#ifdef UNITY_PASS_FORWARDADD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //  UNITY_APPLY_FOG_COLOR(i.fogCoord, color, float4(0,0,0,0));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //#else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //  fixed4 myCustomColor = fixed4(0,0,1,0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //  UNITY_APPLY_FOG_COLOR(i.fogCoord, color, myCustomColor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //#endif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return color;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ENDCG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div><p>}</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[1]: /docs/shader-writing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2]: /docs/materials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3]: /docs/shaders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4]: /docs/sl-surface-shaders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[5]: /docs/comp-mesh-group/class-mesh-renderer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6]: /docs/sl-shader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[7]: /docs/materials/class-material</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[8]: /docs/sl-shader/sl-properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9]: /docs/sl-sub-shader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10]: /docs/sl-pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[11]: /docs/sl-surface-shaders/sl-render-pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[12]: /docs/sl-shader-programs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13]: /docs/sl-shader-programs/sl-shader-semantics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14]: /docs/sl-shader-programs/sl-builtin-includes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[15]: /docs/sl-shader-programs/sl-shader-semantics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[16]: /docs/built-in-shader-examples/built-in-shader-examples-vertex-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17]: /docs/sky/class-skybox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[18]: /docs/lighting-overview/lighting-window</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[19]: /docs/reflection-probes/class-reflection-probe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20]: /docs/textures/class-cubemap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21]: /docs/sl-surface-shaders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[22]: /docs/sl-shader-programs/sl-builtin-includes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[23]: /docs/sl-shader-programs/sl-unity-shader-variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[24]: /docs/sl-shader-programs/sl-builtin-macros</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[25]: /docs/sl-shader/sl-properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[26]: /docs/sl-surface-shaders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[27]: /docs/shaders-overview/class-shader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[28]: /docs/sl-surface-shaders/sl-render-pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29]: /docs/rendering-paths/render-tech-forward-rendering</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[30]: /docs/sl-pass/sl-pass-tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[31]: /docs/sl-shader-programs/sl-unity-shader-variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[32]: /docs/light-probes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[33]: /docs/sl-shader-programs/sl-builtin-includes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[34]: /docs/shader-normal-family/shader-normal-diffuse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[35]: /docs/sl-sub-shader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[36]: /docs/sl-shader/sl-fallback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[37]: /docs/sl-pass/sl-pass-tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[38]: /docs/shader-shaderlab-commands/sl-use-pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[39]: /docs/shader-preprocessor-directives/sl-multiple-program-variants</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[40]: /docs/shader-preprocessor-directives/sl-multiple-program-variants</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[41]: /docs/sl-shader-programs/sl-builtin-includes</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" class="copyButton_wuS7 clean-btn">复制</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/graphics/render-pipelines/built-in-render-pipeline/built-in-shader-examples/sl-vertex-fragment-shader-examples.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/built-in-shader-examples/built-in-shader-examples-vertex-data"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">可视化顶点数据</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/built-in-render-pipeline/graphics-command-buffers"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">使用 CommandBuffer 来扩展内置渲染管线</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#设置场景" class="table-of-contents__link toc-highlight">设置场景</a></li><li><a href="#创建着色器" class="table-of-contents__link toc-highlight">创建着色器</a></li><li><a href="#链接网格材质和着色器" class="table-of-contents__link toc-highlight">链接网格、材质和着色器</a></li><li><a href="#着色器的主要部分" class="table-of-contents__link toc-highlight">着色器的主要部分</a></li><li><a href="#简单的无光照着色器" class="table-of-contents__link toc-highlight">简单的无光照着色器</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.13c240a3.js"></script>
<script src="/assets/js/main.8f4a8c68.js"></script>
</body>
</html>