"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[12950],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return y}});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=l(n),y=o,d=m["".concat(c,".").concat(y)]||m[y]||p[y]||a;return n?r.createElement(d,i(i({ref:t},u),{},{components:n})):r.createElement(d,i({ref:t},u))}));function y(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},54789:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return c},default:function(){return y},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return p}});var r=n(87462),o=n(63366),a=(n(67294),n(3905)),i=["components"],s={id:"JobSystemSafetySystem",title:"C# \u4f5c\u4e1a\u7cfb\u7edf\u4e2d\u7684\u5b89\u5168\u7cfb\u7edf",slug:"/job-system/job-system-safety-system"},c="C",l={unversionedId:"scripting-section/job-system/JobSystemSafetySystem",id:"scripting-section/job-system/JobSystemSafetySystem",title:"C# \u4f5c\u4e1a\u7cfb\u7edf\u4e2d\u7684\u5b89\u5168\u7cfb\u7edf",description:"\u4f5c\u4e1a\u7cfb\u7edf\u4e2d\u7684\u5b89\u5168\u7cfb\u7edf",source:"@site/docs/scripting-section/job-system/job-system-safety-system.md",sourceDirName:"scripting-section/job-system",slug:"/job-system/job-system-safety-system",permalink:"/doc-unity-manual/docs/job-system/job-system-safety-system",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/scripting-section/job-system/job-system-safety-system.md",tags:[],version:"current",frontMatter:{id:"JobSystemSafetySystem",title:"C# \u4f5c\u4e1a\u7cfb\u7edf\u4e2d\u7684\u5b89\u5168\u7cfb\u7edf",slug:"/job-system/job-system-safety-system"},sidebar:"tutorialSidebar",previous:{title:"ParallelForTransform \u4f5c\u4e1a",permalink:"/doc-unity-manual/docs/job-system/job-system-parallel-for-transform-jobs"},next:{title:"\u8c03\u5ea6\u4f5c\u4e1a",permalink:"/doc-unity-manual/docs/job-system/job-system-scheduling-jobs"}},u={},p=[{value:"\u7ade\u4e89\u6761\u4ef6",id:"\u7ade\u4e89\u6761\u4ef6",level:2},{value:"\u5b89\u5168\u7cfb\u7edf",id:"\u5b89\u5168\u7cfb\u7edf",level:2}],m={toc:p};function y(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"c-\u4f5c\u4e1a\u7cfb\u7edf\u4e2d\u7684\u5b89\u5168\u7cfb\u7edf"},"C# \u4f5c\u4e1a\u7cfb\u7edf\u4e2d\u7684\u5b89\u5168\u7cfb\u7edf"),(0,a.kt)("h2",{id:"\u7ade\u4e89\u6761\u4ef6"},"\u7ade\u4e89\u6761\u4ef6"),(0,a.kt)("p",null,"\u7f16\u5199",(0,a.kt)("a",{parentName:"p",href:"/doc-unity-manual/docs/job-system/job-system-multithreading"},"\u591a\u7ebf\u7a0b\u4ee3\u7801"),"\u65f6\uff0c\u603b\u662f\u5b58\u5728\u51fa\u73b0",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Race_condition"},"\u7ade\u4e89\u6761\u4ef6"),"\u7684\u98ce\u9669\u3002\u5f53\u4e00\u4e2a\u64cd\u4f5c\u7684\u8f93\u51fa\u53d6\u51b3\u4e8e\u4e0d\u53d7\u5176\u63a7\u5236\u7684\u53e6\u4e00\u4e2a\u8fc7\u7a0b\u7684\u65f6\u5e8f\u65f6\uff0c\u5373\u51fa\u73b0\u7ade\u4e89\u6761\u4ef6\u3002"),(0,a.kt)("p",null,"A race condition is not always a bug, but it is a source of nondeterministic behavior. When a race condition does cause a bug, it can be hard to find the source of the problem because it depends on timing, so you can only recreate the issue on rare occasions. Debugging it can cause the problem to disappear, because breakpoints and logging can change the timing of individual threads. Race conditions produce the most significant challenge in writing multithreaded code."),(0,a.kt)("h2",{id:"\u5b89\u5168\u7cfb\u7edf"},"\u5b89\u5168\u7cfb\u7edf"),(0,a.kt)("p",null,"\u4e3a\u4e86\u66f4\u5bb9\u6613\u7f16\u5199\u591a\u7ebf\u7a0b\u4ee3\u7801\uff0cUnity C# \u4f5c\u4e1a\u7cfb\u7edf\u53ef\u4ee5\u68c0\u6d4b\u6240\u6709\u6f5c\u5728\u7684\u7ade\u4e89\u6761\u4ef6\uff0c\u5e76\u5c3d\u91cf\u907f\u514d\u53ef\u80fd\u5bfc\u81f4\u7684\u9519\u8bef\u3002"),(0,a.kt)("p",null,"For example: if the C# Job System sends a ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/cpp/cpp/references-cpp"},"reference")," to data from your code in the control thread to a job, it cannot verify whether the control thread is reading the data at the same time the job is writing to it. This scenario creates a race condition."),(0,a.kt)("p",null,"The C# Job System solves this by sending each job a copy of the data it needs to operate on, rather than a reference to the data in the control thread. This copy isolates the data, which eliminates the race condition."),(0,a.kt)("p",null,"C# \u4f5c\u4e1a\u7cfb\u7edf\u590d\u5236\u6570\u636e\u7684\u65b9\u5f0f\u610f\u5473\u7740\u4f5c\u4e1a\u53ea\u80fd\u8bbf\u95ee ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Blittable_types"},"blittable \u6570\u636e\u7c7b\u578b"),"\u3002\u5728",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Managed_code"},"\u6258\u7ba1"),"\u4ee3\u7801\u548c\u672c\u673a\u4ee3\u7801\u4e4b\u95f4\u4f20\u8f93\u65f6\uff0c\u8fd9\u4e9b\u7c7b\u578b\u4e0d\u9700\u8981\u8f6c\u6362\u3002"),(0,a.kt)("p",null,"C# \u4f5c\u4e1a\u7cfb\u7edf\u53ef\u4ee5\u4f7f\u7528 ",(0,a.kt)("a",{parentName:"p",href:"http://www.cplusplus.com/reference/cstring/memcpy/"},"memcpy")," \u590d\u5236 blittable \u7c7b\u578b\uff0c\u5e76\u5728 Unity \u7684\u6258\u7ba1\u90e8\u5206\u548c\u672c\u673a\u90e8\u5206\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u3002\u5728\u8c03\u5ea6\u4f5c\u4e1a\u65f6\uff0c\u7cfb\u7edf\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"memcpy")," \u5c06\u6570\u636e\u653e\u5165\u672c\u673a\u5185\u5b58\uff0c\u5e76\u5728\u6267\u884c\u4f5c\u4e1a\u65f6\u8ba9\u6258\u7ba1\u7aef\u8bbf\u95ee\u8be5\u526f\u672c\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605",(0,a.kt)("a",{parentName:"p",href:"/doc-unity-manual/docs/job-system/job-system-scheduling-jobs"},"\u8c03\u5ea6\u4f5c\u4e1a"),"\u3002"),(0,a.kt)("hr",null),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"2018\u201306\u201315 \u9875\u9762\u5df2\u53d1\u5e03"),(0,a.kt)("li",{parentName:"ul"},"\u5728 ",(0,a.kt)("a",{parentName:"li",href:"https://docs.unity3d.com/2018.1/Documentation/Manual/30_search.html?q=newin20181"},"2018.1")," \u7248\u4e2d\u516c\u5f00\u4e86 C# \u4f5c\u4e1a\u7cfb\u7edf NewIn20181")))}y.isMDXComponent=!0}}]);