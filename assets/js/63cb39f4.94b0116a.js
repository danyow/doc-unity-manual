"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[53149],{3905:function(e,t,i){i.d(t,{Zo:function(){return u},kt:function(){return m}});var r=i(67294);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)i=s[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)i=s[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var p=r.createContext({}),d=function(e){var t=r.useContext(p),i=t;return e&&(i="function"==typeof e?e(t):o(o({},t),e)),i},u=function(e){var t=d(e.components);return r.createElement(p.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var i=e.components,n=e.mdxType,s=e.originalType,p=e.parentName,u=a(e,["components","mdxType","originalType","parentName"]),c=d(i),m=n,h=c["".concat(p,".").concat(m)]||c[m]||l[m]||s;return i?r.createElement(h,o(o({ref:t},u),{},{components:i})):r.createElement(h,o({ref:t},u))}));function m(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=i.length,o=new Array(s);o[0]=c;var a={};for(var p in t)hasOwnProperty.call(t,p)&&(a[p]=t[p]);a.originalType=e,a.mdxType="string"==typeof e?e:n,o[1]=a;for(var d=2;d<s;d++)o[d]=i[d];return r.createElement.apply(null,o)}return r.createElement.apply(null,i)}c.displayName="MDXCreateElement"},2023:function(e,t,i){i.r(t),i.d(t,{assets:function(){return u},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return a},metadata:function(){return d},toc:function(){return l}});var r=i(87462),n=i(63366),s=(i(67294),i(3905)),o=["components"],a={id:"android-RequestingPermissions",title:"Request runtime permissions",slug:"/android-device-features-and-permissions/android-requesting-permissions"},p="Request runtime permissions",d={unversionedId:"platform-specific/android/android-developing/android-device-features-and-permissions/android-RequestingPermissions",id:"platform-specific/android/android-developing/android-device-features-and-permissions/android-RequestingPermissions",title:"Request runtime permissions",description:"This page explains how to request the user\u2019s permission for your application to access data on the device or use a device feature such as a built-in camera or microphone.",source:"@site/docs/platform-specific/android/android-developing/android-device-features-and-permissions/android-requesting-permissions.md",sourceDirName:"platform-specific/android/android-developing/android-device-features-and-permissions",slug:"/android-device-features-and-permissions/android-requesting-permissions",permalink:"/doc-unity-manual/docs/android-device-features-and-permissions/android-requesting-permissions",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/platform-specific/android/android-developing/android-device-features-and-permissions/android-requesting-permissions.md",tags:[],version:"current",frontMatter:{id:"android-RequestingPermissions",title:"Request runtime permissions",slug:"/android-device-features-and-permissions/android-requesting-permissions"},sidebar:"tutorialSidebar",previous:{title:"Android permissions in Unity",permalink:"/doc-unity-manual/docs/android-device-features-and-permissions/android-permissions-in-unity"},next:{title:"Graphics for Android",permalink:"/doc-unity-manual/docs/android-graphics"}},u={},l=[{value:"\u5148\u51b3\u6761\u4ef6",id:"\u5148\u51b3\u6761\u4ef6",level:2},{value:"Request permission at runtime",id:"request-permission-at-runtime",level:2},{value:"Check if the application has permission",id:"check-if-the-application-has-permission",level:3},{value:"Send a request for permission",id:"send-a-request-for-permission",level:3},{value:"Provide a way to manually trigger the permission request",id:"provide-a-way-to-manually-trigger-the-permission-request",level:3}],c={toc:l};function m(e){var t=e.components,i=(0,n.Z)(e,o);return(0,s.kt)("wrapper",(0,r.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"request-runtime-permissions"},"Request runtime permissions"),(0,s.kt)("p",null,"This page explains how to request the user\u2019s permission for your application to access data on the device or use a device feature such as a built-in camera or microphone."),(0,s.kt)("p",null,"Google\u2019s guideline for requesting permissions recommends that, if the user denies a permission request once, you should display the reason for the request and present the request again."),(0,s.kt)("p",null,"For more information on when and how you should request permissions on an Android device, see ",(0,s.kt)("a",{parentName:"p",href:"https://developer.android.com/training/permissions/usage-notes"},"App permissions best practices")," in the Android developer guide."),(0,s.kt)("h2",{id:"\u5148\u51b3\u6761\u4ef6"},"\u5148\u51b3\u6761\u4ef6"),(0,s.kt)("p",null,"The runtime permissions API requires Android version 6 (API level 23). To change your application\u2019s target API:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Select  ",(0,s.kt)("strong",{parentName:"li"},"Edit"),"  ",">","  ",(0,s.kt)("strong",{parentName:"li"},"Project Settings")," ."),(0,s.kt)("li",{parentName:"ol"},"In the Project settings window, select the  ",(0,s.kt)("strong",{parentName:"li"},"Player"),"  tab, then open ",(0,s.kt)("a",{parentName:"li",href:"/doc-unity-manual/docs/android-getting-started/class-player-settings-android"},"Android Player Settings"),":",(0,s.kt)("br",null),(0,s.kt)("img",{parentName:"li",src:"https://docs.unity3d.com/cn/2022.1/uploads/Main/android-player-settings-tab.png",alt:"android-player-settings-tab.png"})),(0,s.kt)("li",{parentName:"ol"},"In the  ",(0,s.kt)("strong",{parentName:"li"},"Publishing Settings"),"  section, set  ",(0,s.kt)("strong",{parentName:"li"},"Target API Level"),"  to at least level 23.")),(0,s.kt)("p",null,"Before the application requests permission to use restricted data or a particular device feature, it must declare the permission in its ",(0,s.kt)("a",{parentName:"p",href:"/doc-unity-manual/docs/android-introducing/android-manifest"},"Android App Manifest"),". For more information, see ",(0,s.kt)("a",{parentName:"p",href:"/doc-unity-manual/docs/android-device-features-and-permissions/android-permissions-declare"},"Declare permissions for an application"),"."),(0,s.kt)("h2",{id:"request-permission-at-runtime"},"Request permission at runtime"),(0,s.kt)("p",null,"The ",(0,s.kt)("a",{parentName:"p",href:"https://docs.unity3d.com/cn/2022.1/ScriptReference/Android.Permission.html"},"Android.Permission")," API provides functionality that you can use to check what permissions the application currently has and request permissions that the application requires but doesn\u2019t have."),(0,s.kt)("p",null,"An overview of the process to request permission at runtime is as follows:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Check whether the user has already given the application permission. If they have, you don\u2019t need to request it again."),(0,s.kt)("li",{parentName:"ol"},"If the user hasn\u2019t given permission, send a request for permission to access the data or use the device feature that the application requires."),(0,s.kt)("li",{parentName:"ol"},"If the user doesn\u2019t give the application permission, disable the application\u2019s functionality that requires the specific permission. If the application can\u2019t work without this functionality, inform the user."),(0,s.kt)("li",{parentName:"ol"},"If the user still doesn\u2019t give the application permission, it\u2019s best practice to provide a method that lets the user manually trigger the permission request again from inside the application.")),(0,s.kt)("h3",{id:"check-if-the-application-has-permission"},"Check if the application has permission"),(0,s.kt)("p",null,"Use ",(0,s.kt)("a",{parentName:"p",href:"https://docs.unity3d.com/cn/2022.1/ScriptReference/Android.Permission.HasUserAuthorizedPermission.html"},"Permission.HasUserAuthorizedPermission")," to check if the user has already given permission for the data or feature the application requires."),(0,s.kt)("p",null,"For a code sample that shows how to use this API, see ",(0,s.kt)("a",{parentName:"p",href:"https://docs.unity3d.com/cn/2022.1/ScriptReference/Android.Permission.HasUserAuthorizedPermission.html"},"Permission.HasUserAuthorizedPermission"),"."),(0,s.kt)("h3",{id:"send-a-request-for-permission"},"Send a request for permission"),(0,s.kt)("p",null,"Use ",(0,s.kt)("a",{parentName:"p",href:"https://docs.unity3d.com/cn/2022.1/ScriptReference/Android.Permission.RequestUserPermission.html"},"Permission.RequestUserPermission")," to request the permission to use the data or feature. When you call this function, Android opens the system permission dialog that the user can use to approve or deny the permission."),(0,s.kt)("p",null,"For a code sample that shows how to use this API, see ",(0,s.kt)("a",{parentName:"p",href:"https://docs.unity3d.com/cn/2022.1/ScriptReference/Android.Permission.RequestUserPermission.html"},"Permission.RequestUserPermission"),"."),(0,s.kt)("p",null," ",(0,s.kt)("strong",{parentName:"p"},"Tip")," : When you request permission, it\u2019s best practice to show the user a message that explains why the application requires the feature."),(0,s.kt)("p",null," ",(0,s.kt)("strong",{parentName:"p"},"Note")," : If the user previously checked the  ",(0,s.kt)("strong",{parentName:"p"},"Do not ask me again"),"  option on the system permission dialog, or has denied the permission more than once, ",(0,s.kt)("inlineCode",{parentName:"p"},"RequestUserPermission()")," doesn\u2019t open the system dialog. In this case, the user must go into the application permission settings and manually turn on the permission."),(0,s.kt)("h3",{id:"provide-a-way-to-manually-trigger-the-permission-request"},"Provide a way to manually trigger the permission request"),(0,s.kt)("p",null,"If the user still denies the application the permission that it requires, provide a way for the user to manually display the permission request dialogue. How to do this depends on the application, but one solution is to provide a button that calls ",(0,s.kt)("a",{parentName:"p",href:"https://docs.unity3d.com/cn/2022.1/ScriptReference/Android.Permission.RequestUserPermission.html"},"Permission.RequestUserPermission"),"."))}m.isMDXComponent=!0}}]);