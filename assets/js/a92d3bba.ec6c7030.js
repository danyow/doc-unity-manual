"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[38320],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return b}});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,l=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=s(n),b=o,f=m["".concat(p,".").concat(b)]||m[b]||u[b]||l;return n?r.createElement(f,a(a({ref:t},c),{},{components:n})):r.createElement(f,a({ref:t},c))}));function b(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=n.length,a=new Array(l);a[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:o,a[1]=i;for(var s=2;s<l;s++)a[s]=n[s];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},80539:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return b},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return u}});var r=n(87462),o=n(63366),l=(n(67294),n(3905)),a=["components"],i={id:"webgl-memory",title:"WebGL \u4e2d\u7684\u5185\u5b58",slug:"/webgl-develop/webgl-memory"},p="WebGL \u4e2d\u7684\u5185\u5b58",s={unversionedId:"platform-specific/webgl/webgl-develop/webgl-memory",id:"platform-specific/webgl/webgl-develop/webgl-memory",title:"WebGL \u4e2d\u7684\u5185\u5b58",description:"Unity WebGL \u4e2d\u7684\u5185\u5b58\u9650\u5236\u53ef\u80fd\u4f1a\u9650\u5236\u53ef\u4ee5\u8fd0\u884c\u7684\u5185\u5bb9\u7684\u590d\u6742\u6027\u3002",source:"@site/docs/platform-specific/webgl/webgl-develop/webgl-memory.md",sourceDirName:"platform-specific/webgl/webgl-develop",slug:"/webgl-develop/webgl-memory",permalink:"/docs/webgl-develop/webgl-memory",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/platform-specific/webgl/webgl-develop/webgl-memory.md",tags:[],version:"current",frontMatter:{id:"webgl-memory",title:"WebGL \u4e2d\u7684\u5185\u5b58",slug:"/webgl-develop/webgl-memory"},sidebar:"tutorialSidebar",previous:{title:"Interaction with browser scripting",permalink:"/docs/webgl-develop/webgl-interactingwithbrowserscripting"},next:{title:"WebGL \u7f51\u7edc",permalink:"/docs/webgl-develop/webgl-networking"}},c={},u=[{value:"Unity \u5806",id:"unity-\u5806",level:2},{value:"\u8d44\u6e90\u6570\u636e",id:"\u8d44\u6e90\u6570\u636e",level:2},{value:"Large-Allocation HTTP \u6807\u5934",id:"large-allocation-http-\u6807\u5934",level:2},{value:"\u5783\u573e\u6536\u96c6\u6ce8\u610f\u4e8b\u9879",id:"\u5783\u573e\u6536\u96c6\u6ce8\u610f\u4e8b\u9879",level:2}],m={toc:u};function b(e){var t=e.components,n=(0,o.Z)(e,a);return(0,l.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"webgl-\u4e2d\u7684\u5185\u5b58"},"WebGL \u4e2d\u7684\u5185\u5b58"),(0,l.kt)("p",null,"Unity WebGL \u4e2d\u7684\u5185\u5b58\u9650\u5236\u53ef\u80fd\u4f1a\u9650\u5236\u53ef\u4ee5\u8fd0\u884c\u7684\u5185\u5bb9\u7684\u590d\u6742\u6027\u3002"),(0,l.kt)("p",null,"WebGL \u5185\u5bb9\u5728\u6d4f\u89c8\u5668\u4e2d\u8fd0\u884c\u3002\u6d4f\u89c8\u5668\u5728\u5176\u5185\u5b58\u7a7a\u95f4\u4e2d\u5206\u914d\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u5185\u5bb9\u6240\u9700\u7684\u5185\u5b58\u3002 \u53ef\u7528\u5185\u5b58\u91cf\u56e0\u4ee5\u4e0b\u56e0\u7d20\u800c\u5f02\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u7684\u8bbe\u5907"),(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u7684\u64cd\u4f5c\u7cfb\u7edf"),(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\uff0c\u4ee5\u53ca\u662f\u5728 32 \u4f4d\u8fd8\u662f 64 \u4f4d\u5904\u7406\u5668\u4e0a\u8fd0\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u6d4f\u89c8\u5668\u7684 JavaScript \u5f15\u64ce\u89e3\u6790\u4ee3\u7801\u6240\u9700\u7684\u5185\u5b58\u91cf"),(0,l.kt)("li",{parentName:"ul"},"\u6d4f\u89c8\u5668\u4e3a\u6bcf\u4e2a\u9009\u9879\u5361\u4f7f\u7528\u5355\u72ec\u8fdb\u7a0b\uff0c\u8fd8\u662f\u5185\u5bb9\u9700\u8981\u4e0e\u6240\u6709\u5176\u4ed6\u6253\u5f00\u7684\u9009\u9879\u5361\u5171\u4eab\u5185\u5b58\u7a7a\u95f4\u3002")),(0,l.kt)("p",null,"Unity WebGL \u5185\u5bb9\u5728\u51e0\u4e2a\u65b9\u9762\u9700\u8981\u6d4f\u89c8\u5668\u5206\u914d\u5927\u91cf\u5185\u5b58\u3002"),(0,l.kt)("h2",{id:"unity-\u5806"},"Unity \u5806"),(0,l.kt)("p",null,"Unity \u4f7f\u7528\u5185\u5b58\u5806\u5b58\u50a8\u6240\u6709 Unity \u5f15\u64ce\u8fd0\u884c\u65f6\u5bf9\u8c61\u3002\u8fd9\u4e9b\u5305\u62ec\u6258\u7ba1\u548c\u539f\u751f\u5bf9\u8c61\u3001\u52a0\u8f7d\u7684\u8d44\u6e90\u3001\u573a\u666f\u548c\u7740\u8272\u5668\u3002\u8fd9\u7c7b\u4f3c\u4e8e Unity \u64ad\u653e\u5668\u5728\u5176\u4ed6\u5e73\u53f0\u4e0a\u4f7f\u7528\u7684\u5185\u5b58\u3002"),(0,l.kt)("p",null,"Unity \u5806\u662f\u5206\u914d\u7684\u8fde\u7eed\u5185\u5b58\u5757\u3002Unity \u652f\u6301\u81ea\u52a8\u8c03\u6574\u5806\u5927\u5c0f\u4ee5\u6ee1\u8db3\u5e94\u7528\u7a0b\u5e8f\u7684\u9700\u8981\u3002\u5806\u5927\u5c0f\u53ef\u968f\u7740\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u800c\u6269\u5c55\uff0c\u6700\u591a\u53ef\u4ee5\u6269\u5c55\u5230 2GB\u3002Unity \u5c06\u6b64\u5185\u5b58\u5806\u521b\u5efa\u4e3a",(0,l.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/Memory"},"\u5185\u5b58\u5bf9\u8c61"),"\u3002\u5185\u5b58\u5bf9\u8c61\u7684\u7f13\u51b2\u533a\u5c5e\u6027\u662f\u53ef\u8c03\u6574\u5927\u5c0f\u7684 ArrayBuffer\uff0c\u7528\u4e8e\u4fdd\u5b58 WebAssembly \u4ee3\u7801\u8bbf\u95ee\u7684\u5185\u5b58\u7684\u539f\u59cb\u5b57\u8282\u3002"),(0,l.kt)("p",null,"Automatic resizing of the heap can cause your application to crash if the browser fails to allocate a contiguous memory block in the address space. For this reason, it is important to keep the Unity heap size as small as possible. Therefore, be mindful when you are planning the memory usage of your application. If you want to test the size of your Unity heap, you can use the ",(0,l.kt)("a",{parentName:"p",href:"/docs/profiler"},"Profiler")," to profile the contents of the memory block."),(0,l.kt)("p",null,"You can control the initial size and growth of the heap by the memory growth options in the ",(0,l.kt)("a",{parentName:"p",href:"/docs/webgl-gettingstarted/class-player-settings-web-gl"},"WebGL Player Settings"),". The default options are configured to work well for all desktop use cases. However, for mobile browsers you need to use the advanced tuning options. For mobile browsers, it\u2019s recommended to configure the  ",(0,l.kt)("strong",{parentName:"p"},"Initial Memory Size"),"  to the typical heap usage of the application."),(0,l.kt)("h2",{id:"\u8d44\u6e90\u6570\u636e"},"\u8d44\u6e90\u6570\u636e"),(0,l.kt)("p",null,"\u521b\u5efa Unity WebGL \u6784\u5efa\u65f6\uff0cUnity \u4f1a\u751f\u6210\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},".data")," \u6587\u4ef6\u3002\u8fd9\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u542f\u52a8\u7684\u6240\u6709\u573a\u666f\u548c\u8d44\u6e90\u3002\u56e0\u4e3a Unity WebGL \u65e0\u6cd5\u8bbf\u95ee\u5b9e\u9645\u6587\u4ef6\u7cfb\u7edf\uff0c\u6240\u4ee5\u4f1a\u521b\u5efa\u865a\u62df\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf\uff0c\u6d4f\u89c8\u5668\u4f1a\u5728\u6b64\u5904\u89e3\u538b\u7f29 ",(0,l.kt)("inlineCode",{parentName:"p"},".data")," \u6587\u4ef6\u3002Emscipten \u6846\u67b6 (JavaScript) \u5728\u6d4f\u89c8\u5668\u5185\u5b58\u7a7a\u95f4\u4e2d\u5206\u914d\u6b64\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf\u3002\u5185\u5bb9\u8fd0\u884c\u65f6\uff0c\u6d4f\u89c8\u5668\u5185\u5b58\u4f1a\u4fdd\u7559\u672a\u538b\u7f29\u7684\u6570\u636e\u3002\u4e3a\u4e86\u7f29\u77ed\u4e0b\u8f7d\u65f6\u95f4\u548c\u964d\u4f4e\u5185\u5b58\u4f7f\u7528\u91cf\uff0c\u5e94\u5c3d\u91cf\u4fdd\u6301\u672a\u538b\u7f29\u6570\u636e\u5c3d\u53ef\u80fd\u5c0f\u3002"),(0,l.kt)("p",null,"\u4e3a\u4e86\u51cf\u5c11\u5185\u5b58\u4f7f\u7528\u91cf\uff0c\u53ef\u4ee5\u5c06\u8d44\u6e90\u6570\u636e\u6253\u5305\u5230 AssetBundles \u4e2d\u3002\u901a\u8fc7 AssetBundles \u53ef\u4ee5\u5b8c\u5168\u63a7\u5236\u8d44\u6e90\u4e0b\u8f7d\u3002\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u63a7\u5236\u5e94\u7528\u7a0b\u5e8f\u4f55\u65f6\u4e0b\u8f7d\u8d44\u6e90\uff0c\u4ee5\u53ca\u8fd0\u884c\u65f6\u4f55\u65f6\u5378\u8f7d\u5b83\u3002\u5378\u8f7d\u672a\u4f7f\u7528\u7684\u8d44\u6e90\u53ef\u91ca\u653e\u5185\u5b58\u3002"),(0,l.kt)("p",null,"AssetBundles \u76f4\u63a5\u4e0b\u8f7d\u5230 Unity \u5806\u4e2d\uff0c\u56e0\u6b64\u8fd9\u4e9b\u5185\u5bb9\u4e0d\u4f1a\u5bfc\u81f4\u6d4f\u89c8\u5668\u8fdb\u884c\u989d\u5916\u5206\u914d\u3002"),(0,l.kt)("p",null,"\u542f\u7528 ",(0,l.kt)("strong",{parentName:"p"},"\u6570\u636e\u7f13\u5b58")," \u53ef\u5c06\u5185\u5bb9\u4e2d\u7684\u8d44\u6e90\u6570\u636e\u81ea\u52a8\u7f13\u5b58\u5728\u7528\u6237\u8ba1\u7b97\u673a\u4e0a\u3002\u8fd9\u610f\u5473\u7740\u65e0\u9700\u5728\u4ee5\u540e\u7684\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u91cd\u65b0\u4e0b\u8f7d\u8be5\u6570\u636e\u3002Unity WebGL \u52a0\u8f7d\u7a0b\u5e8f\u4f7f\u7528 IndexedDB API \u5b9e\u73b0\u6570\u636e\u7f13\u5b58\u3002\u6b64\u9009\u9879\u4f7f\u60a8\u53ef\u4ee5\u7f13\u5b58\u5bf9\u4e8e\u6d4f\u89c8\u5668\u800c\u8a00\u592a\u5927\u800c\u65e0\u6cd5\u5728\u672c\u673a\u7f13\u5b58\u7684\u6587\u4ef6\u3002"),(0,l.kt)("p",null,"\u6570\u636e\u7f13\u5b58\u4f7f\u6d4f\u89c8\u5668\u80fd\u591f\u5c06\u5e94\u7528\u7a0b\u5e8f\u6570\u636e\u5b58\u50a8\u5728\u7528\u6237\u7684\u8ba1\u7b97\u673a\u4e0a\u3002\u6d4f\u89c8\u5668\u901a\u5e38\u4f1a\u9650\u5236\u53ef\u4ee5\u5728\u5176\u7f13\u5b58\u4e2d\u5b58\u50a8\u7684\u91cf\u4ee5\u53ca\u53ef\u4ee5\u7f13\u5b58\u7684\u6700\u5927\u6587\u4ef6\u5927\u5c0f\u3002\u8fd9\u901a\u5e38\u4e0d\u8db3\u4ee5\u4f7f\u5e94\u7528\u7a0b\u5e8f\u987a\u7545\u8fd0\u884c\u3002\u56e0\u6b64\uff0cUnity WebGL \u52a0\u8f7d\u7a0b\u5e8f\u4f7f\u7528 IndexedDB API \u5b9e\u73b0\u6570\u636e\u7f13\u5b58\u3002Unity \u4f1a\u5c06\u6570\u636e\u5b58\u50a8\u5728 IndexedDB \u4e2d\uff0c\u800c\u4e0d\u662f\u5c06\u5185\u5bb9\u5b58\u50a8\u5728\u6d4f\u89c8\u5668\u7f13\u5b58\u4e2d\u3002"),(0,l.kt)("p",null,"\u8981\u542f\u7528\u6570\u636e\u7f13\u5b58\u9009\u9879\uff0c\u8bf7\u8f6c\u5230  ",(0,l.kt)("strong",{parentName:"p"},"File"),"  ",">","  ",(0,l.kt)("strong",{parentName:"p"},"Build Settings"),"  ",">","  ",(0,l.kt)("strong",{parentName:"p"},"Player Settings"),"  ",">","  ",(0,l.kt)("strong",{parentName:"p"},"Publishing Settings")," \u3002"),(0,l.kt)("h2",{id:"large-allocation-http-\u6807\u5934"},"Large-Allocation HTTP \u6807\u5934"),(0,l.kt)("p",null,"\u60a8\u7684\u670d\u52a1\u5668\u53ef\u4e3a\u60a8\u7684\u5185\u5bb9\u53d1\u51fa ",(0,l.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Large-Allocation"},"Large-Allocation")," HTTP \u6807\u5934\u3002\u8fd9\u4f1a\u5411\u652f\u6301\u7684\u6d4f\u89c8\u5668\uff08\u76ee\u524d\u53ea\u6709 Mozilla Firefox\uff09\u544a\u77e5\u60a8\u7684\u5185\u5b58\u9700\u6c42\u3002\u6b64\u4fe1\u606f\u4f7f\u652f\u6301\u7684\u6d4f\u89c8\u5668\u53ef\u4ee5\u4f7f\u7528\u672a\u5206\u6bb5\u7684\u5185\u5b58\u7a7a\u95f4\u751f\u6210\u65b0\u8fdb\u7a0b\u3002\u6d4f\u89c8\u5668\u8fd8\u53ef\u4ee5\u8fdb\u884c\u989d\u5916\u7684\u5185\u52a1\u5904\u7406\u4ee5\u786e\u4fdd\u5927\u578b\u5206\u914d\u6210\u529f\u3002 \u8fd9\u53ef\u4ee5\u89e3\u51b3\u6d4f\u89c8\u5668\u5728\u5c1d\u8bd5\u5206\u914d Unity \u5806\u65f6\u5185\u5b58\u4e0d\u8db3\u7684\u95ee\u9898\u3002\u8fd9\u5728 32 \u4f4d\u6d4f\u89c8\u5668\u4e0a\u5c24\u5176\u91cd\u8981\u3002"),(0,l.kt)("h2",{id:"\u5783\u573e\u6536\u96c6\u6ce8\u610f\u4e8b\u9879"},"\u5783\u573e\u6536\u96c6\u6ce8\u610f\u4e8b\u9879"),(0,l.kt)("p",null,"\u5783\u573e\u6536\u96c6\u662f\u67e5\u627e\u548c\u91ca\u653e\u672a\u4f7f\u7528\u5185\u5b58\u7684\u8fc7\u7a0b\u3002\u4e00\u65e6\u5783\u573e\u56de\u6536\u5668\u6536\u96c6\u4e86\u672a\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u5b83\u4fbf\u4f1a\u5728 Unity \u5806\u4e2d\u91cd\u65b0\u5206\u914d\u8fd9\u4e9b\u5185\u5b58\u3002"),(0,l.kt)("p",null,"For an overview on how Unity garbage collection works, see ",(0,l.kt)("a",{parentName:"p",href:"/docs/performance-memory-overview/performance-managed-memory"},"Automatic Memory Management"),". WebGL garbage collection runs when the stack is empty. The stack is a part of the Unity heap but not the heap itself. This usually occurs after every frame. This is different from the garbage collection process on other platforms, where the collector pauses all running threads so it can inspect the stack. This is not possible in JavaScript. You can debug the garbage collection process using the Unity ",(0,l.kt)("a",{parentName:"p",href:"/docs/profiler"},"Profiler"),"."),(0,l.kt)("p",null,"\u5728\u5927\u591a\u6570\u5176\u4ed6\u5e73\u53f0\u4e0a\uff0c\u5783\u573e\u6536\u96c6\u4f1a\u6682\u505c\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u3002\u5783\u573e\u56de\u6536\u5668\u968f\u540e\u4f1a\u68c0\u67e5\u5176\u5806\u6808\u5e76\u6ce8\u518c\u52a0\u8f7d\u7684\u5bf9\u8c61\u5f15\u7528\u3002\u76ee\u524d\u5728 JavaScript \u4e2d\u8fd8\u65e0\u6cd5\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002\u56e0\u6b64\uff0c\u53ea\u6709\u5728\u5806\u6808\u4e3a\u7a7a\u7684\u60c5\u51b5\u4e0b\uff0c\u5783\u573e\u56de\u6536\u5668\u624d\u4f1a\u5728 WebGL \u4e2d\u8fd0\u884c\u3002\u6b64\u64cd\u4f5c\u5f53\u524d\u5728\u6bcf\u4e00\u5e27\u4e4b\u540e\u53d1\u751f\u4e00\u6b21\u3002"),(0,l.kt)("p",null,"\u56e0\u6b64\uff0c\u4ee5\u4e0b\u4ee3\u7801\u5c06\u65e0\u6cd5\u5728 WebGL \u4e0a\u8fd0\u884c\u3002\u8fd9\u662f\u56e0\u4e3a\u56de\u6536\u5668\u65e0\u6cd5\u5728\u5faa\u73af\u7684\u8fed\u4ee3\u4e4b\u95f4\u8fd0\u884c\u5783\u573e\u56de\u6536\u5668\u3002\u8fd9\u610f\u5473\u7740\u5783\u573e\u56de\u6536\u5668\u65e0\u6cd5\u91ca\u653e\u4e2d\u95f4\u5b57\u7b26\u4e32\u5bf9\u8c61\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u53ef\u80fd\u4f1a\u8017\u5c3d Unity \u5806\u4e2d\u7684\u5185\u5b58\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'string hugeString = "";\n \nfor (int i = 0; i &lt; 100000; i++)\n \n{\n \n  hugeString += "foo";\n \n}\n')),(0,l.kt)("hr",null),(0,l.kt)("p",null,"\u5728 2020.1 \u4e2d\u5f15\u5165\u4e86\u66f4\u65b0\u7684 WebGL \u52a0\u8f7d\u7a0b\u5e8f"))}b.isMDXComponent=!0}}]);